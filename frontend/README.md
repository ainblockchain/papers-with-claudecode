# Frontend

Next.js ê¸°ë°˜ ë…¼ë¬¸ íƒìƒ‰ ë° ì§€ì‹ ê·¸ë˜í”„ í•™ìŠµ í”Œë«í¼ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜.

## Tech Stack

- **Framework**: Next.js (App Router)
- **Authentication**: GitHub OAuth

## Core Features

| ê¸°ëŠ¥ | ë¼ìš°íŠ¸ | ì„¤ëª… |
|------|--------|------|
| **GitHub Login** | `/login` | GitHub OAuthë¥¼ í†µí•œ ì†Œì…œ ë¡œê·¸ì¸ |
| **My Dashboard** | `/dashboard` | ì‚¬ìš©ì ê°œì¸ ëŒ€ì‹œë³´ë“œ. í•™ìŠµ í†µê³„, ì§„í–‰ ì¤‘ì¸ ë…¼ë¬¸, í™œë™ ë‚´ì—­ |
| **Explore** | `/explore` | ë…¼ë¬¸ ê²€ìƒ‰ ë° íƒìƒ‰ (HuggingFace Papers ìŠ¤íƒ€ì¼). "Learn (Claude Code)" ë²„íŠ¼ìœ¼ë¡œ í•™ìŠµ ì‹œì‘ |
| **Learn** | `/learn/[paperId]` | 60/40 ë¶„í•  í•™ìŠµ ë·° â€” ì¢Œì¸¡ ë˜ì „ ìº”ë²„ìŠ¤ + ìš°ì¸¡ Claude Code ì›¹ í„°ë¯¸ë„ |
| **Village** | `/village` | 2D íƒ€ì¼ë§µ ë§ˆì„. ê³¼ëª©ë³„ ë˜ì „ ì…êµ¬, ì¹œêµ¬ ìœ„ì¹˜, ë¦¬ë”ë³´ë“œ, ì›”ë“œë§µ |
| **Publish** | `/publish` | _To be continued_ |

---

## User Flow

> ì „ì²´ ì‚¬ìš©ì ê²½í—˜ í”Œë¡œìš°. ìƒì„¸ êµ¬í˜„ ìŠ¤í™ì€ `TODO.md` ì°¸ì¡°.

```
[Explore Page]                    [Learning View]                     [Village]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   "Learn" í´ë¦­   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Paper Cards â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚ Dungeon  â”‚ Claude   â”‚  ë˜ì „ íƒˆì¶œ  â”‚ 2D ë§ˆì„  â”‚
â”‚ (HF style)  â”‚                  â”‚ Canvas   â”‚ Code     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ ë˜ì „ ì…êµ¬ â”‚
â”‚             â”‚                  â”‚ (60%)    â”‚ Terminal â”‚            â”‚ ì¹œêµ¬ ìœ„ì¹˜ â”‚
â”‚ [Learn â–¶]  â”‚                  â”‚          â”‚ (40%)    â”‚            â”‚ ë¦¬ë”ë³´ë“œ  â”‚
â”‚ [GitHub â˜…] â”‚                  â”‚ Stage 1  â”‚ í•™ìŠµ+í€´ì¦ˆâ”‚            â”‚ ì•Œë¦¼     â”‚
â”‚ [arXiv ğŸ“„] â”‚                  â”‚   â†“ ğŸ”“   â”‚          â”‚            â”‚          â”‚
â”‚             â”‚                  â”‚ Stage 2  â”‚          â”‚            â”‚          â”‚
â”‚             â”‚                  â”‚   â†“ ...  â”‚          â”‚            â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚                                  â”‚
                                       â”‚  x402 ê²°ì œë¡œ                      â”‚
                                       â”‚  ë‹¤ìŒ ìŠ¤í…Œì´ì§€ í•´ê¸ˆ               â”‚
                                       â”‚                                  â”‚
                                  [Checkpoint DBì— ì €ì¥]           [ì¹œêµ¬ ì•Œë¦¼ ìˆ˜ì‹ ]
```

### Flow Detail

1. **Explore** â€” ìœ ì €ëŠ” HuggingFace Papers Trendingê³¼ ìœ ì‚¬í•œ UIì—ì„œ ë…¼ë¬¸ì„ íƒìƒ‰í•œë‹¤
2. **Learn ë²„íŠ¼** â€” ë…¼ë¬¸ ì¹´ë“œì˜ "Learn (Claude Code)" ë²„íŠ¼ í´ë¦­ ì‹œ `/learn/[paperId]`ë¡œ ì´ë™
3. **60/40 Split View** â€” ì¢Œì¸¡ 60%ëŠ” 2D ë˜ì „ ìº”ë²„ìŠ¤, ìš°ì¸¡ 40%ëŠ” Claude Code ì›¹ í„°ë¯¸ë„
4. **Stage Learning** â€” ìœ ì €ëŠ” ë˜ì „ ë‚´ ì¹ íŒ ì˜¤ë¸Œì íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•˜ë©° ê°œë…ì„ í•™ìŠµí•˜ê³ , Claude Code í„°ë¯¸ë„ì—ì„œ AIì™€ ëŒ€í™”í•˜ë©° ì‹¬í™” í•™ìŠµ
5. **Quiz Gate** â€” ìŠ¤í…Œì´ì§€ ì™„ë£Œ ì‹œ í€´ì¦ˆë¥¼ í’€ì–´ì•¼ ë‹¤ìŒ ë°©ìœ¼ë¡œ ì´ë™ ê°€ëŠ¥
6. **x402 Payment** â€” ë‹¤ìŒ ìŠ¤í…Œì´ì§€ì˜ ì ê¸´ ë¬¸ì„ x402 í”„ë¡œí† ì½œ ê²°ì œë¡œ í•´ê¸ˆ
7. **Checkpoint** â€” ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ì‹œë§ˆë‹¤ DBì— ì²´í¬í¬ì¸íŠ¸ ì €ì¥. ë‚˜ê°”ë‹¤ ëŒì•„ì™€ë„ ì§„í–‰ë„ ìœ ì§€
8. **Exit to Village** â€” ë˜ì „ì„ ë‚˜ê°€ë©´ 2D ë§ˆì„ ë·°ë¡œ ì´ë™. ë‹¤ì–‘í•œ ë…¼ë¬¸ ì£¼ì œì˜ ë˜ì „ ê±´ë¬¼ ë°°ì¹˜
9. **Social** â€” ë§ˆì„/ë˜ì „ì—ì„œ ì¹œêµ¬ ìºë¦­í„° ìœ„ì¹˜ í™•ì¸ ê°€ëŠ¥. ì¹œêµ¬ê°€ ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ ì‹œ ì•Œë¦¼ íŒì—…
10. **Dynamic Map** â€” ë§ˆì„ ë§µì€ Gemini APIë¥¼ í™œìš©í•´ ì•„ì›ƒí˜ì¸íŒ… ë°©ì‹ìœ¼ë¡œ ë™ì  ìƒì„±

---

## UI Layout & Design Reference

> Hugging Face Papers Trending í˜ì´ì§€(https://huggingface.co/papers/trending)ë¥¼ ë ˆí¼ëŸ°ìŠ¤ë¡œ ë¶„ì„í•œ UI ë°°ì¹˜ ë° ë””ìì¸ ëª…ì„¸.

### ì „ì²´ í˜ì´ì§€ êµ¬ì¡° (Explore í˜ì´ì§€ ê¸°ì¤€)

í˜ì´ì§€ëŠ” í¬ê²Œ **Header(ë„¤ë¹„ê²Œì´ì…˜ ë°”)**, **Hero Section(í˜ì´ì§€ í—¤ë”)**, **Paper List(ë…¼ë¬¸ ë¦¬ìŠ¤íŠ¸)** ë¡œ êµ¬ì„±ëœë‹¤. ë°°ê²½ì€ `#FFFFFF` í°ìƒ‰ì´ë©°, ìµœëŒ€ ì½˜í…ì¸  í­ì€ ì•½ 1280pxë¡œ ì¤‘ì•™ ì •ë ¬ëœë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Logo]                    [Nav Items]          [GitHub Login/Avatar]â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Explore Papers             [AI Search Bar]    Daily|Weekly|Monthly  â”‚  â† Hero Section
â”‚  Discover the latest research                                        â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Thumbnailâ”‚  Title (h3, bold, link)             â”‚ [â˜… GitHub   N] â”‚ â”‚
â”‚  â”‚         â”‚  Description (gray, 1-2 lines)      â”‚ [ğŸ“„ arXiv Page]â”‚ â”‚  â† Paper Card
â”‚  â”‚         â”‚  Authors Â· Published on Date         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚
â”‚  â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Thumbnailâ”‚  Title                              â”‚ [â˜… GitHub   N] â”‚ â”‚
â”‚  â”‚         â”‚  Description                        â”‚ [ğŸ“„ arXiv Page]â”‚ â”‚  â† Paper Card
â”‚  â”‚         â”‚  Authors Â· Published on Date         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚
â”‚  ...                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1. Header (Global Navigation Bar)

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **ë¡œê³ ** | ì¢Œì¸¡ ìƒë‹¨. ì•„ì´ì½˜ + ì„œë¹„ìŠ¤ëª…. í™ˆ(`/`)ìœ¼ë¡œ ë§í¬ |
| **ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´** | ê°€ë¡œ ì •ë ¬: Explore, Dashboard, Publish |
| **ì¸ì¦ ì˜ì—­** | ë¹„ë¡œê·¸ì¸ ì‹œ: "GitHubë¡œ ë¡œê·¸ì¸" ë²„íŠ¼. ë¡œê·¸ì¸ ì‹œ: ì‚¬ìš©ì ì•„ë°”íƒ€ + ë“œë¡­ë‹¤ìš´ ë©”ë‰´ |

- ë†’ì´: ì•½ 48~56px
- ë°°ê²½: `#FFFFFF`, í•˜ë‹¨ì— ë¯¸ì„¸í•œ border/shadow
- í°íŠ¸: 14~15px, ì¤‘ê°„ weight

---

### 2. Hero Section (Explore í˜ì´ì§€ í—¤ë”)

ì¢Œìš° 2ì—´ ë°°ì¹˜:

**ì¢Œì¸¡:**
- `h1` "Explore Papers" â€” bold, ì•½ 28~32px, ê²€ì •
- ë¶€ì œëª© â€” íšŒìƒ‰, ì•½ 14px

**ìš°ì¸¡:**
- **AI ê²€ìƒ‰ ë°”**: ì•„ì´ì½˜(âœ¨) + placeholder "Search any paper with AI". ë¼ìš´ë“œ border, ì•½ 400px í­
- **ê¸°ê°„ í•„í„° íƒ­**: `Daily` | `Weekly` | `Monthly` â€” í…ìŠ¤íŠ¸ ë²„íŠ¼, ì„ íƒ ì‹œ bold/underline

---

### 3. Paper Card (ë…¼ë¬¸ ì¹´ë“œ â€” í•µì‹¬ ë°˜ë³µ ì»´í¬ë„ŒíŠ¸)

ê° ì¹´ë“œëŠ” `<article>` ìš”ì†Œë¡œ êµ¬ì„±ë˜ë©° ìˆ˜ì§ìœ¼ë¡œ ë‚˜ì—´ëœë‹¤. ì¹´ë“œ ê°„ êµ¬ë¶„ì€ ì–‡ì€ border-top (`1px solid #E5E7EB`).

#### ë ˆì´ì•„ì›ƒ: 3ì—´ êµ¬ì¡°

```
[Thumbnail]  [Content Area]                              [Action Buttons]
  ~160px         flex-grow                                  ~120px
```

#### 3-1. Thumbnail (ì¢Œì¸¡)

- ë…¼ë¬¸ ì²« í˜ì´ì§€ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€
- í¬ê¸°: ì•½ 160x200px
- border-radius: 8px
- í•˜ë‹¨ ì˜¤ë²„ë ˆì´: ì œì¶œì ì •ë³´ ("Submitted by @username") â€” ë°˜íˆ¬ëª… ë°°ê²½
- ìƒë‹¨ ìš°ì¸¡: ì¡°ì§ ë±ƒì§€ (ì˜ˆ: "Google", "IBM Granite") â€” ë¼ìš´ë“œ pill

#### 3-2. Content Area (ì¤‘ì•™)

| ìš”ì†Œ | ìŠ¤íƒ€ì¼ |
|------|--------|
| **ì œëª©** | `h3`, bold, ì•½ 18~20px, ê²€ì •. í´ë¦­ ì‹œ ë…¼ë¬¸ ìƒì„¸ë¡œ ì´ë™ |
| **ì„¤ëª…** | íšŒìƒ‰ (`#6B7280`), 14px, ìµœëŒ€ 2ì¤„. ë…¼ë¬¸ ìš”ì•½ |
| **ì €ì ëª©ë¡** | ì•„ë°”íƒ€ ì•„ì´ì½˜(ì›í˜•, ~20px) ë‚˜ì—´ + "N authors" í…ìŠ¤íŠ¸ |
| **ê²Œì‹œì¼** | "Â· Published on Feb 15, 2026" â€” íšŒìƒ‰, 14px |
| **ì¡°ì§ ë±ƒì§€** | (ì¼ë¶€ ì¹´ë“œ) ì¡°ì§ ë¡œê³  + ì´ë¦„ pill |

#### 3-3. Action Buttons (ìš°ì¸¡)

ì„¸ë¡œ ì •ë ¬ëœ 2ê°œ ë²„íŠ¼:

| ë²„íŠ¼ | ìŠ¤íƒ€ì¼ |
|------|--------|
| **GitHub** | `â˜… GitHub [N]` â€” outline ë²„íŠ¼, star ìˆ˜ í‘œì‹œ. GitHub ì €ì¥ì†Œë¡œ ë§í¬ |
| **arXiv Page** | `ğŸ“„ arXiv Page` â€” outline ë²„íŠ¼, arXiv ë…¼ë¬¸ ë§í¬ |

- ë²„íŠ¼ í­: ì•½ 120~140px
- ê°„ê²©: ê° ë²„íŠ¼ ì‚¬ì´ 4~8px
- ìŠ¤íƒ€ì¼: ì—°í•œ íšŒìƒ‰ border, í° ë°°ê²½, hover ì‹œ ë°°ê²½ìƒ‰ ë³€ê²½

---

### 4. ë””ìì¸ í† í° ìš”ì•½

| í† í° | ê°’ |
|------|-----|
| **Primary Color** | `#FF9D00` (ì£¼í™© â€” ì£¼ìš” ì•¡ì„¼íŠ¸) |
| **Text Primary** | `#111827` (ê±°ì˜ ê²€ì •) |
| **Text Secondary** | `#6B7280` (íšŒìƒ‰ â€” ì„¤ëª…, ë‚ ì§œ, ì €ì) |
| **Border Color** | `#E5E7EB` (ì¹´ë“œ êµ¬ë¶„ì„ ) |
| **Background** | `#FFFFFF` |
| **Border Radius** | 8px (ì¹´ë“œ, ë²„íŠ¼), 9999px (pill/ë±ƒì§€) |
| **Font Family** | Source Sans Pro / system sans-serif |
| **Card Padding** | ì•½ 16~24px |
| **Content Max Width** | ~1280px, ì¤‘ì•™ ì •ë ¬ |

---

### 5. ë°˜ì‘í˜• ê³ ë ¤ì‚¬í•­

- ë°ìŠ¤í¬í†±(1920px) ê¸°ì¤€ ë¶„ì„ì´ë©°, ëª¨ë°”ì¼ì—ì„œëŠ” 3ì—´ â†’ 1ì—´ ìŠ¤íƒ ë ˆì´ì•„ì›ƒìœ¼ë¡œ ì „í™˜
- Thumbnailì´ ìƒë‹¨, Contentê°€ ì¤‘ê°„, Action ë²„íŠ¼ì´ í•˜ë‹¨ìœ¼ë¡œ ì¬ë°°ì¹˜
- ë„¤ë¹„ê²Œì´ì…˜ì€ í–„ë²„ê±° ë©”ë‰´ë¡œ ì¶•ì†Œ

---

### 6. ì°¸ê³  ìŠ¤í¬ë¦°ìƒ·

- `huggingface-papers-trending.png` â€” í˜ì´ì§€ ìƒë‹¨ (Header + Title + ì²« 4ê°œ ì¹´ë“œ)
- `huggingface-papers-trending-scrolled.png` â€” ìŠ¤í¬ë¡¤ í›„ ì¶”ê°€ ì¹´ë“œ í™•ì¸

---

## AINSpace â€” LMS ì¬êµ¬ì„± ëª…ì„¸

> ê¸°ì¡´ AINSpace(2D íƒ€ì¼ë§µ ê°€ìƒ ë§ˆì„)ì˜ ì¸í”„ë¼ë¥¼ ìœ ì§€í•˜ë©´ì„œ, LMS(í•™ìŠµ ê´€ë¦¬ ì‹œìŠ¤í…œ) ì»¨ì…‰ìœ¼ë¡œ ì¬êµ¬ì„±í•œë‹¤.

### ì°¸ê³  ì´ë¯¸ì§€

- `reference/ainspace-lms-village.png` â€” ë§ˆì„ ì „ì²´ ë·° (ë˜ì „ ì…êµ¬, ì¹œêµ¬, ë¦¬ë”ë³´ë“œ, ì›”ë“œë§µ)
- `reference/ainspace-lms-dungeon.png` â€” ë˜ì „ ë‚´ë¶€ (ìŠ¤í…Œì´ì§€, í•™ìŠµ ì½˜í…ì¸ , í€´ì¦ˆ ê²Œì´íŠ¸)

### ì „ì²´ í™”ë©´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [LMS Logo]  ë‚´ ê°•ì˜ì‹¤ | í˜„ì¬ í•™ìŠµ ì¤‘: â—‹â—‹ ë˜ì „ | ì§„í–‰ë„: 16% (ìŠ¤í…Œì´ì§€ 1/7) [ğŸ‘¤]â”‚ â† Top Bar
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    â”‚                                                         â”‚ ì¶œì„ ì¤‘ì¸ ì¹œêµ¬ë“¤â”‚
â”‚ ëŒ€ â”‚                                                         â”‚  ì¹œêµ¬ A ğŸŸ¢ St.2â”‚
â”‚ ì‹œ â”‚              2D íƒ€ì¼ë§µ ë©”ì¸ ë·°                           â”‚  ì¹œêµ¬ B ğŸ”´ St.3â”‚
â”‚ ë³´ â”‚         (ë§ˆì„ / ë˜ì „ ë‚´ë¶€ ì „í™˜)                           â”‚               â”‚
â”‚ ë“œ â”‚                                                         â”‚ ë¦¬ë”ë³´ë“œ       â”‚
â”‚    â”‚                                                         â”‚  1. ì¹œêµ¬B St.3 â”‚
â”‚ ìˆ˜ â”‚                                                         â”‚  2. ì¹œêµ¬A St.2 â”‚
â”‚ ê°• â”‚                                                         â”‚  3. ë‚˜    St.1 â”‚
â”‚ ì‹  â”‚                                                         â”‚               â”‚
â”‚ ì²­ â”‚                                                         â”‚               â”‚
â”‚    â”‚                                                         â”‚               â”‚
â”‚ ì˜· â”‚                                                         â”‚               â”‚
â”‚    â”‚                                                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì»¤ â”‚                                                         â”‚ [ì›”ë“œë§µ/       â”‚
â”‚ ë®¤ â”‚                                                         â”‚  ìŠ¤í…Œì´ì§€ ë§µ]  â”‚
â”‚ ë‹ˆ â”‚                                                         â”‚               â”‚
â”‚ í‹° â”‚                                                         â”‚               â”‚
â”œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
```

### 1. Top Bar (ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜)

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **LMS Logo** | ì¢Œì¸¡. í™ˆìœ¼ë¡œ ì´ë™ |
| **ë‚´ ê°•ì˜ì‹¤** | ìˆ˜ê°• ì¤‘ì¸ ê³¼ëª© ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™ |
| **í˜„ì¬ í•™ìŠµ ìƒíƒœ** | "í˜„ì¬ í•™ìŠµ ì¤‘: ê°•í™”í•™ìŠµ (Reinforcement Learning) ë˜ì „" â€” í˜„ì¬ í™œë™ ì»¨í…ìŠ¤íŠ¸ í‘œì‹œ |
| **ì§„í–‰ë„** | "ì§„í–‰ë„: 16% (ìŠ¤í…Œì´ì§€ 1/7)" â€” í”„ë¡œê·¸ë ˆìŠ¤ í‘œì‹œ |
| **í”„ë¡œí•„** | ìš°ì¸¡ ë. ì‚¬ìš©ì ì•„ë°”íƒ€ |

### 2. Left Sidebar (ì¢Œì¸¡ ì‚¬ì´ë“œë°”)

ì•„ì´ì½˜ + í…ìŠ¤íŠ¸ ì„¸ë¡œ ë©”ë‰´:

| ë©”ë‰´ | ì„¤ëª… |
|------|------|
| **ëŒ€ì‹œë³´ë“œ** | í•™ìŠµ í˜„í™© ìš”ì•½, í†µê³„ |
| **ìˆ˜ê°•ì‹ ì²­** | ìƒˆë¡œìš´ ê³¼ëª©(ë˜ì „) íƒìƒ‰ ë° ë“±ë¡ |
| **ì˜·** | ìºë¦­í„° ì»¤ìŠ¤í„°ë§ˆì´ì§• |
| **ì»¤ë®¤ë‹ˆí‹°** | ì†Œì…œ ê¸°ëŠ¥, ì±„íŒ… |

### 3. Main View â€” ë§ˆì„ (Village)

ê¸°ì¡´ AINSpace 2D íƒ€ì¼ë§µì„ í•™ìŠµ ë§ˆì„ë¡œ ì¬êµ¬ì„±:

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **ë˜ì „ ì…êµ¬ë“¤** | ê° ê³¼ëª©ì´ ë˜ì „ìœ¼ë¡œ í‘œí˜„ë¨. ì˜ˆ: "ë”¥ëŸ¬ë‹(DL) ë˜ì „ ì…êµ¬", "ê°•í™”í•™ìŠµ(RL) ë˜ì „ ì…êµ¬", "A2A ë˜ì „ ì…êµ¬". ê±´ë¬¼ í˜•íƒœë¡œ ë§µì— ë°°ì¹˜ |
| **í”Œë ˆì´ì–´ ìºë¦­í„°** | ì‚¬ìš©ì ì•„ë°”íƒ€(íŒŒë€ ìºë¦­í„°)ê°€ ë§ˆì„ì„ ëŒì•„ë‹¤ë‹˜ |
| **ì¹œêµ¬ ìºë¦­í„°** | ê°™ì€ ë§ˆì„ì— ì ‘ì†í•œ ì¹œêµ¬ë“¤ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ì„. ë§í’ì„ ìœ¼ë¡œ ì§„í–‰ ìƒíƒœ ê³µìœ  ("ìŠ¤í…Œì´ì§€ 3 í´ë¦¬ì–´ ğŸ†") |
| **NPC / ê°€ì´ë“œ** | í•™ìŠµ ì•ˆë‚´ ìºë¦­í„° (ì„ íƒ) |

### 4. Main View â€” ë˜ì „ ë‚´ë¶€ (Dungeon Stage)

ë˜ì „ ì…êµ¬ì— ì§„ì…í•˜ë©´ í•´ë‹¹ ê³¼ëª©ì˜ í•™ìŠµ ê³µê°„ìœ¼ë¡œ ì „í™˜:

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **ìŠ¤í…Œì´ì§€ ë°©** | "ìŠ¤í…Œì´ì§€ 1: ê¸°ì´ˆ ê°œë…ì˜ ë°©" â€” ê° ë°©ì´ í•˜ë‚˜ì˜ í•™ìŠµ ë‹¨ê³„ |
| **í•™ìŠµ ì½˜í…ì¸ ** | ì¹ íŒ ì˜¤ë¸Œì íŠ¸ì— í•µì‹¬ ê°œë… í‘œì‹œ (ì˜ˆ: "Agent", "Reward"). ìƒí˜¸ì‘ìš© ì‹œ ìƒì„¸ í•™ìŠµ ìë£Œ ì—´ëŒ |
| **í€´ì¦ˆ ê²Œì´íŠ¸** | ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ ê°€ëŠ” ë¬¸ ì•ì— ì ê¸ˆ. "ìŠ¤í…Œì´ì§€ 2ë¡œ ì´ë™ (í€´ì¦ˆ í†µê³¼ í•„ìš”)" â€” í€´ì¦ˆë¥¼ í’€ì–´ì•¼ í†µê³¼ |
| **ìŠ¤í…Œì´ì§€ ê°„ ì´ë™** | ë¬¸ì„ í†µí•´ ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ ì—°ê²°. ì„ í˜• ì§„í–‰ (St.1 â†’ St.2 â†’ St.3 â†’ ...) |
| **í•¨ê»˜ í‘¸ëŠ” ì¹œêµ¬** | ê°™ì€ ë˜ì „ì— ìˆëŠ” ì¹œêµ¬ê°€ ë³´ì„. ì‹¤ì‹œê°„ ìœ„ì¹˜ ê³µìœ  |

### 5. Right Sidebar (ìš°ì¸¡ ì‚¬ì´ë“œë°”)

ì»¨í…ìŠ¤íŠ¸ì— ë”°ë¼ ë‚´ìš©ì´ ì „í™˜ë¨:

**ë§ˆì„ ë·°ì¼ ë•Œ:**

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **ì¶œì„ ì¤‘ì¸ ì¹œêµ¬ë“¤** | í˜„ì¬ ì ‘ì† ì¤‘ì¸ ì¹œêµ¬ ëª©ë¡ + ê°ì ì§„í–‰ ì¤‘ì¸ ìŠ¤í…Œì´ì§€ (ğŸŸ¢ ì˜¨ë¼ì¸ / ğŸ”´ ë°”ì¨) |
| **ë¦¬ë”ë³´ë“œ** | í•™ìŠµ ì§„í–‰ë„ ìˆœìœ„. "1. ì¹œêµ¬B (RL St.3) / 2. ì¹œêµ¬A (DL St.2) / 3. ë‚˜ (RL St.1)" |
| **ì›”ë“œë§µ** | ìš°í•˜ë‹¨. ê³¼ëª©ë³„ ë˜ì „ ìœ„ì¹˜ë¥¼ ë¯¸ë‹ˆë§µìœ¼ë¡œ í‘œì‹œ. RL, DL, A2A ì˜ì—­ì´ ìƒ‰ìƒìœ¼ë¡œ êµ¬ë¶„ë¨ |

**ë˜ì „ ë‚´ë¶€ì¼ ë•Œ:**

| ìš”ì†Œ | ì„¤ëª… |
|------|------|
| **í•¨ê»˜ í’€ì¸ ì¹œêµ¬ë“¤** | ê°™ì€ ë˜ì „ ì•ˆì— ìˆëŠ” ì¹œêµ¬ ëª©ë¡ + ê°ì ìŠ¤í…Œì´ì§€ |
| **ìŠ¤í…Œì´ì§€ ë§µ** | ìš°í•˜ë‹¨. í˜„ì¬ ë˜ì „ì˜ ìŠ¤í…Œì´ì§€ ì§„í–‰ íë¦„ë„ (St.1 â†’ St.2 â†’ St.3). í˜„ì¬ ìœ„ì¹˜, ì¹œêµ¬ ìœ„ì¹˜ í‘œì‹œ |

### 6. í•µì‹¬ LMS í•™ìŠµ í”Œë¡œìš°

```
ìˆ˜ê°•ì‹ ì²­ â†’ ë§ˆì„ì—ì„œ ë˜ì „ ì…êµ¬ë¡œ ì´ë™ â†’ ë˜ì „ ì§„ì…
  â†’ ìŠ¤í…Œì´ì§€ 1 (ê¸°ì´ˆ ê°œë… í•™ìŠµ, ì¹ íŒ ìƒí˜¸ì‘ìš©)
  â†’ í€´ì¦ˆ í†µê³¼ â†’ ìŠ¤í…Œì´ì§€ 2 ì§„ì…
  â†’ ... ë°˜ë³µ ...
  â†’ ìµœì¢… ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´ â†’ ê³¼ëª© ì™„ë£Œ
```

### 7. ê¸°ì¡´ AINSpaceì—ì„œ ìœ ì§€í•˜ëŠ” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **2D íƒ€ì¼ë§µ ë Œë”ë§** | Canvas ê¸°ë°˜ íƒ€ì¼ë§µ, 3-ë ˆì´ì–´ ì‹œìŠ¤í…œ |
| **ìºë¦­í„° ì´ë™** | í‚¤ë³´ë“œ/í„°ì¹˜ ê¸°ë°˜ ì´ë™, ì¶©ëŒ ì²˜ë¦¬ |
| **ì›”ë › ì¸ì¦** | Coinbase Wallet ì—°ë™, Base ì²´ì¸ ê¸°ë°˜ |
| **ì‹¤ì‹œê°„ ì±„íŒ…** | SSE ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°, ë§í’ì„  |
| **ë§µ íƒí—˜** | ë§ˆì„/ë˜ì „ ê°„ ì”¬ ì „í™˜, ë¯¸ë‹ˆë§µ |
| **ìºë¦­í„° ì»¤ìŠ¤í„°ë§ˆì´ì§•** | ì˜·/ì™¸í˜• ë³€ê²½ |

---

# AINSpace Frontend - ì™„ì „í•œ ê°œë°œ ë¬¸ì„œ (ì¸ìˆ˜ì¸ê³„ìš©)

> **í”„ë¡œì íŠ¸**: AINSpace â€” AI ì—ì´ì „íŠ¸ê°€ 2D ê°€ìƒ ë§ˆì„ì—ì„œ ììœ¨ì ìœ¼ë¡œ ìƒí˜¸ì‘ìš©í•˜ëŠ” Web3 ë©”íƒ€ë²„ìŠ¤ MiniApp
> **ë²„ì „**: 1.0.3
> **ì›ë³¸ ê²½ë¡œ**: `ain-space/ainspace`

---

## ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ](#2-ê¸°ìˆ -ìŠ¤íƒ)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#3-í”„ë¡œì íŠ¸-êµ¬ì¡°)
4. [í™˜ê²½ ì„¤ì • ë° ì‹¤í–‰](#4-í™˜ê²½-ì„¤ì •-ë°-ì‹¤í–‰)
5. [ì•„í‚¤í…ì²˜ ê°œìš”](#5-ì•„í‚¤í…ì²˜-ê°œìš”)
6. [ë¼ìš°íŒ… êµ¬ì¡°](#6-ë¼ìš°íŒ…-êµ¬ì¡°)
7. [ìƒíƒœ ê´€ë¦¬ (Zustand Stores)](#7-ìƒíƒœ-ê´€ë¦¬-zustand-stores)
8. [í•µì‹¬ ë°ì´í„° íƒ€ì…](#8-í•µì‹¬-ë°ì´í„°-íƒ€ì…)
9. [Provider ê³„ì¸µ êµ¬ì¡°](#9-provider-ê³„ì¸µ-êµ¬ì¡°)
10. [ì¸ì¦ ì‹œìŠ¤í…œ (AuthGuard)](#10-ì¸ì¦-ì‹œìŠ¤í…œ-authguard)
11. [í˜ì´ì§€ë³„ ìƒì„¸ êµ¬í˜„](#11-í˜ì´ì§€ë³„-ìƒì„¸-êµ¬í˜„)
12. [ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜](#12-ì»´í¬ë„ŒíŠ¸-ì•„í‚¤í…ì²˜)
13. [ê²Œì„ ì‹œìŠ¤í…œ ìƒì„¸](#13-ê²Œì„-ì‹œìŠ¤í…œ-ìƒì„¸)
14. [ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ](#14-ì—ì´ì „íŠ¸-ì‹œìŠ¤í…œ)
15. [ë§µ ë¹Œë”© ì‹œìŠ¤í…œ](#15-ë§µ-ë¹Œë”©-ì‹œìŠ¤í…œ)
16. [ì±„íŒ… ë° ìŠ¤ë ˆë”© ì‹œìŠ¤í…œ](#16-ì±„íŒ…-ë°-ìŠ¤ë ˆë”©-ì‹œìŠ¤í…œ)
17. [Custom Hooks ìƒì„¸](#17-custom-hooks-ìƒì„¸)
18. [ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬](#18-ìœ í‹¸ë¦¬í‹°-ë¼ì´ë¸ŒëŸ¬ë¦¬)
19. [API ë¼ìš°íŠ¸ ìƒì„¸](#19-api-ë¼ìš°íŠ¸-ìƒì„¸)
20. [ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™](#20-ì™¸ë¶€-ì„œë¹„ìŠ¤-ì—°ë™)
21. [ìŠ¤íƒ€ì¼ë§ ì‹œìŠ¤í…œ](#21-ìŠ¤íƒ€ì¼ë§-ì‹œìŠ¤í…œ)
22. [ë¹Œë“œ ë° ë°°í¬](#22-ë¹Œë“œ-ë°-ë°°í¬)
23. [í•µì‹¬ ë™ì‘ íë¦„](#23-í•µì‹¬-ë™ì‘-íë¦„)
24. [ì„¤ì • íŒŒì¼ ìƒì„¸](#24-ì„¤ì •-íŒŒì¼-ìƒì„¸)
25. [ì£¼ì˜ì‚¬í•­ ë° ì•Œë ¤ì§„ ì´ìŠˆ](#25-ì£¼ì˜ì‚¬í•­-ë°-ì•Œë ¤ì§„-ì´ìŠˆ)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

AINSpaceëŠ” **2D íƒ€ì¼ë§µ ê¸°ë°˜ ê°€ìƒ ë§ˆì„**ì—ì„œ AI ì—ì´ì „íŠ¸ë“¤ì´ ììœ¨ì ìœ¼ë¡œ í™œë™í•˜ëŠ” Web3 MiniAppì´ë‹¤. ì‚¬ìš©ìëŠ” ì§€ê°‘ì„ ì—°ê²°í•˜ê³ , ë§ˆì„ì„ íƒí—˜í•˜ë©°, A2A(Agent-to-Agent) í”„ë¡œí† ì½œì„ í†µí•´ AI ì—ì´ì „íŠ¸ë¥¼ ì„í¬íŠ¸í•˜ê³ , ì—ì´ì „íŠ¸ì™€ ëŒ€í™”í•  ìˆ˜ ìˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ì›”ë › ì¸ì¦** | Coinbase Wallet ì—°ë™, Base ì²´ì¸ ê¸°ë°˜ ë¡œê·¸ì¸ |
| **2D íƒ€ì¼ë§µ** | 105x105 íƒ€ì¼ ë§µ, Canvas ë Œë”ë§, 3-ë ˆì´ì–´ ì‹œìŠ¤í…œ |
| **AI ì—ì´ì „íŠ¸** | A2A í”„ë¡œí† ì½œ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì„í¬íŠ¸/ë°°ì¹˜/ëŒ€í™” |
| **ë§µ ë¹Œë”©** | ì•„ì´í…œ ë°°ì¹˜, ì¶©ëŒ ë§µ, ì»¤ìŠ¤í…€ íƒ€ì¼ í¼ë¸”ë¦¬ì‹œ |
| **ì‹¤ì‹œê°„ ì±„íŒ…** | SSE ê¸°ë°˜ ìŠ¤íŠ¸ë¦¬ë°, ìŠ¤ë ˆë“œ ëŒ€í™”, ë¸Œë¡œë“œìºìŠ¤íŠ¸ |
| **Farcaster MiniApp** | Farcaster í”„ë ˆì„ SDK í†µí•© |

---

## 2. ê¸°ìˆ  ìŠ¤íƒ

### Core

| ë¶„ë¥˜ | ê¸°ìˆ  | ë²„ì „ |
|------|------|------|
| **í”„ë ˆì„ì›Œí¬** | Next.js (App Router) | 15.5.9 |
| **UI ë¼ì´ë¸ŒëŸ¬ë¦¬** | React | 19.1.0 |
| **ì–¸ì–´** | TypeScript (strict mode) | ^5 |
| **ìƒíƒœê´€ë¦¬** | Zustand | 5.0.8 |
| **ìŠ¤íƒ€ì¼ë§** | Tailwind CSS v4 + PostCSS | ^4 |

### Web3 / Blockchain

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **wagmi** (2.18.2) | React hooks for Ethereum |
| **viem** (2.38.3) | Ethereum ìœ í‹¸ë¦¬í‹° |
| **@coinbase/onchainkit** (latest) | Base ì²´ì¸ í†µí•©, MiniKit |
| **@farcaster/miniapp-sdk** (0.2.1) | Farcaster í”„ë ˆì„ í†µí•© |

### AI / Agent

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **@a2a-js/sdk** (0.3.4) | Agent-to-Agent í”„ë¡œí† ì½œ |
| **@google/generative-ai** (0.24.1) | Gemini API |
| **openai** (6.2.0) | ChatGPT API |

### Backend / Storage

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **redis** (5.8.2) | ë°ì´í„° ì˜ì†í™” (ìœ„ì¹˜, íƒ€ì¼, ì—ì´ì „íŠ¸, ìŠ¤ë ˆë“œ) |
| **@vercel/blob** (2.0.0) | íŒŒì¼ ìŠ¤í† ë¦¬ì§€ |
| **firebase-admin** (13.6.0) | Firebase ë°±ì—”ë“œ ì„œë¹„ìŠ¤ |

### UI Components

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **lucide-react** | ì•„ì´ì½˜ |
| **react-joystick-component** | ëª¨ë°”ì¼ ì¡°ì´ìŠ¤í‹± |
| **react-sprite-animator** | ìŠ¤í”„ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ |
| **react-markdown** | ë§ˆí¬ë‹¤ìš´ ë Œë”ë§ |
| **vaul** | Drawer ì»´í¬ë„ŒíŠ¸ |
| **@radix-ui/react-dialog** | ë‹¤ì´ì–¼ë¡œê·¸ |
| **class-variance-authority** | ì»´í¬ë„ŒíŠ¸ ë³€í˜• |

### DevTools

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **@sentry/nextjs** (10.22.0) | ì—ëŸ¬ íŠ¸ë˜í‚¹ |
| **@vercel/analytics** (1.5.0) | ë¶„ì„ |
| **eruda** (3.4.3) | ëª¨ë°”ì¼ ë””ë²„ê¹… (ê°œë°œí™˜ê²½ ì „ìš©) |
| **sharp** (0.34.4) | ì´ë¯¸ì§€ ì²˜ë¦¬ |
| **prettier** + **prettier-plugin-tailwindcss** | ì½”ë“œ í¬ë§¤íŒ… |

### íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €

```
yarn@1.22.19
```

---

## 3. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ainspace/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ map/                        # íƒ€ì¼ë§µ ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤
â”‚   â”‚   â”œâ”€â”€ tiles/                  # 5x5 ë¶„í•  íƒ€ì¼ ì´ë¯¸ì§€
â”‚   â”‚   â”‚   â””â”€â”€ land_layer_1/       # tile_0_0.webp ~ tile_4_4.webp
â”‚   â”‚   â”œâ”€â”€ land_layer_0.webp       # ê¸°ë³¸ ì§€í˜• ë ˆì´ì–´
â”‚   â”‚   â””â”€â”€ land_layer_1.webp       # ì¶©ëŒ ê°ì§€ìš© ë ˆì´ì–´
â”‚   â”œâ”€â”€ footer/bottomTab/           # í•˜ë‹¨ íƒ­ ì•„ì´ì½˜ SVG
â”‚   â”œâ”€â”€ login/                      # ë¡œê·¸ì¸ í˜ì´ì§€ ì´ë¯¸ì§€
â”‚   â””â”€â”€ items/                      # ì•„ì´í…œ ì´ë¯¸ì§€
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                        # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ (Providers + AuthGuard)
â”‚   â”‚   â”œâ”€â”€ page.tsx                # ë©”ì¸ ê²Œì„ í˜ì´ì§€ (/)
â”‚   â”‚   â”œâ”€â”€ globals.css             # ì „ì—­ ìŠ¤íƒ€ì¼ + Tailwind ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx            # ì›”ë › ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ api/                    # ì„œë²„ì‚¬ì´ë“œ API ë¼ìš°íŠ¸ (19ê°œ)
â”‚   â”‚       â”œâ”€â”€ agents/
â”‚   â”‚       â”‚   â”œâ”€â”€ route.ts        # GET/POST/PUT/DELETE ì—ì´ì „íŠ¸ CRUD
â”‚   â”‚       â”‚   â””â”€â”€ upload-image/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts    # ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ
â”‚   â”‚       â”œâ”€â”€ agent-chat/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # A2A ì—ì´ì „íŠ¸ ì±„íŒ…
â”‚   â”‚       â”œâ”€â”€ agent-proxy/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # A2A ì¹´ë“œ í”„ë¡ì‹œ
â”‚   â”‚       â”œâ”€â”€ agent-response/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # Gemini AI ì‘ë‹µ ìƒì„±
â”‚   â”‚       â”œâ”€â”€ create-agent/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # AI í”„ë¡¬í”„íŠ¸ë¡œ ì—ì´ì „íŠ¸ ìƒì„±
â”‚   â”‚       â”œâ”€â”€ threads/
â”‚   â”‚       â”‚   â”œâ”€â”€ route.ts        # GET/POST ìŠ¤ë ˆë“œ ê´€ë¦¬
â”‚   â”‚       â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts    # GET/DELETE ê°œë³„ ìŠ¤ë ˆë“œ
â”‚   â”‚       â”œâ”€â”€ thread-message/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # ìŠ¤ë ˆë“œ ë©”ì‹œì§€ ì „ì†¡
â”‚   â”‚       â”œâ”€â”€ thread-stream/
â”‚   â”‚       â”‚   â””â”€â”€ [threadId]/
â”‚   â”‚       â”‚       â””â”€â”€ route.ts    # SSE ìŠ¤íŠ¸ë¦¬ë° í”„ë¡ì‹œ
â”‚   â”‚       â”œâ”€â”€ custom-tiles/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # GET/POST ì»¤ìŠ¤í…€ íƒ€ì¼
â”‚   â”‚       â”œâ”€â”€ position/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # GET/POST í”Œë ˆì´ì–´ ìœ„ì¹˜
â”‚   â”‚       â”œâ”€â”€ commentary/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # Gemini í•´ì„¤ ìƒì„±
â”‚   â”‚       â”œâ”€â”€ clear-layer1/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # ì¶©ëŒ ë ˆì´ì–´ ì´ˆê¸°í™”
â”‚   â”‚       â”œâ”€â”€ convert-image/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # ì´ë¯¸ì§€ í¬ë§· ë³€í™˜
â”‚   â”‚       â”œâ”€â”€ convert-status/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts        # ìƒíƒœ ë°ì´í„° ë³€í™˜
â”‚   â”‚       â””â”€â”€ upload-tile/
â”‚   â”‚           â””â”€â”€ route.ts        # íƒ€ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ tabs/                   # íƒ­ ë·° ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ MapTab.tsx          # ê²Œì„ ë§µ + ì¡°ì´ìŠ¤í‹± + ì±„íŒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ AgentTab.tsx        # ì—ì´ì „íŠ¸ ê´€ë¦¬ UI
â”‚   â”‚   â”‚   â””â”€â”€ TempBuildTab.tsx    # ë§µ ë¹Œë”© UI
â”‚   â”‚   â”œâ”€â”€ agent-builder/          # ì—ì´ì „íŠ¸ ë¹Œë” UI
â”‚   â”‚   â”‚   â”œâ”€â”€ ImportAgentSection.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CreateAgentSection.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ImportedAgentList.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ImportedAgentCard.tsx
â”‚   â”‚   â”œâ”€â”€ overlays/               # ì˜¤ë²„ë ˆì´/ëª¨ë‹¬
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatBoxOverlay.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatBottomDrawer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HolderModal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ LoadingModal.tsx
â”‚   â”‚   â”œâ”€â”€ ui/                     # ê³µìš© UI ì»´í¬ë„ŒíŠ¸ (Shadcn ê¸°ë°˜)
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Dialog.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Drawer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Spinner.tsx
â”‚   â”‚   â”‚   â””â”€â”€ context-menu.tsx
â”‚   â”‚   â”œâ”€â”€ canvas/                 # ìº”ë²„ìŠ¤ ê´€ë ¨
â”‚   â”‚   â”œâ”€â”€ controls/               # ê²Œì„ ì»¨íŠ¸ë¡¤ (ì¡°ì´ìŠ¤í‹± ë“±)
â”‚   â”‚   â”œâ”€â”€ TileMap.tsx             # í•µì‹¬: ìº”ë²„ìŠ¤ ê¸°ë°˜ ë§µ ë Œë”ëŸ¬
â”‚   â”‚   â”œâ”€â”€ ChatBox.tsx             # í•µì‹¬: ë©”ì¸ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ Footer.tsx              # í•˜ë‹¨ íƒ­ ë„¤ë¹„ê²Œì´ì…˜
â”‚   â”‚   â””â”€â”€ AuthGuard.tsx           # ì¸ì¦ ê°€ë“œ
â”‚   â”œâ”€â”€ stores/                     # Zustand ìƒíƒœ ì €ì¥ì†Œ (7ê°œ)
â”‚   â”‚   â”œâ”€â”€ index.ts                # ìŠ¤í† ì–´ í†µí•© export
â”‚   â”‚   â”œâ”€â”€ useUIStore.ts
â”‚   â”‚   â”œâ”€â”€ useGameStateStore.ts
â”‚   â”‚   â”œâ”€â”€ useAgentStore.ts
â”‚   â”‚   â”œâ”€â”€ useThreadStore.ts
â”‚   â”‚   â”œâ”€â”€ useBuildStore.ts
â”‚   â”‚   â”œâ”€â”€ useChatStore.ts
â”‚   â”‚   â””â”€â”€ useMapStore.ts
â”‚   â”œâ”€â”€ hooks/                      # Custom React Hooks (10ê°œ)
â”‚   â”‚   â”œâ”€â”€ useGameState.tsx        # ê²Œì„ ìƒíƒœ + ì´ë™ + ì¶©ëŒ
â”‚   â”‚   â”œâ”€â”€ useAgents.ts            # ì—ì´ì „íŠ¸ AI í–‰ë™
â”‚   â”‚   â”œâ”€â”€ useSession.ts           # Firebase ì¸ì¦
â”‚   â”‚   â”œâ”€â”€ useTiledMap.ts          # TMJ ë§µ ë¡œë“œ + ë Œë”ë§
â”‚   â”‚   â”œâ”€â”€ useThreadStream.ts      # SSE ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼
â”‚   â”‚   â”œâ”€â”€ useProgressiveImage.ts  # ì´ë¯¸ì§€ ì§€ì—° ë¡œë”©
â”‚   â”‚   â”œâ”€â”€ useSpritePreload.ts     # ìŠ¤í”„ë¼ì´íŠ¸ í”„ë¦¬ë¡œë“œ
â”‚   â”‚   â”œâ”€â”€ useKeyboardOpen.ts      # ëª¨ë°”ì¼ í‚¤ë³´ë“œ ê°ì§€
â”‚   â”‚   â”œâ”€â”€ useSearchHolders.ts     # í† í° í™€ë” ê²€ì¦
â”‚   â”‚   â””â”€â”€ useWorld.ts             # ì›”ë“œ ìƒíƒœ
â”‚   â”œâ”€â”€ lib/                        # ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”‚   â”œâ”€â”€ a2aOrchestration.ts     # A2A ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ agent.ts                # ì—ì´ì „íŠ¸ í´ë˜ìŠ¤ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ redis.ts                # Redis í´ë¼ì´ì–¸íŠ¸ + CRUD
â”‚   â”‚   â”œâ”€â”€ wagmi-config.ts         # Wagmi ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ utils.ts                # ìœ í‹¸ í•¨ìˆ˜ (cn, createSession, shortAddress)
â”‚   â”‚   â”œâ”€â”€ hash.ts                 # SHA-256 í•´ì‹œ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ firebase.ts             # Firebase ì´ˆê¸°í™”
â”‚   â”‚   â”œâ”€â”€ gemini.ts               # Gemini API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ initializeAgents.ts     # ê¸°ë³¸ ì—ì´ì „íŠ¸ ì´ˆê¸°í™”
â”‚   â”‚   â”œâ”€â”€ world.ts                # ì›”ë“œ ìƒíƒœ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ jobManager.ts           # ë¹„ë™ê¸° ì‘ì—… ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ messageDAG.ts           # ë©”ì‹œì§€ DAG êµ¬ì¡°
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ Providers.tsx           # ë£¨íŠ¸ í”„ë¡œë°”ì´ë” (Wagmi + QueryClient + OnchainKit)
â”‚   â”‚   â””â”€â”€ MapDataProvider.tsx     # ë§µ ë°ì´í„° Context
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”œâ”€â”€ game.ts                 # ê²Œì„ ìƒìˆ˜
â”‚   â”‚   â”œâ”€â”€ common.ts               # ê³µí†µ ìƒìˆ˜ (Z_INDEX)
â”‚   â”‚   â””â”€â”€ agentContract.ts        # ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ABI
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ thread.ts               # Thread íƒ€ì… ì •ì˜
â”œâ”€â”€ package.json
â”œâ”€â”€ next.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ postcss.config.mjs
â”œâ”€â”€ components.json                  # Shadcn UI ì„¤ì •
â”œâ”€â”€ sentry.server.config.ts
â”œâ”€â”€ sentry.edge.config.ts
â”œâ”€â”€ instrumentation.ts
â””â”€â”€ .prettierrc
```

---

## 4. í™˜ê²½ ì„¤ì • ë° ì‹¤í–‰

### í™˜ê²½ ë³€ìˆ˜ (.env)

```env
# AI API Keys
GEMINI_API_KEY=                          # Google Gemini API í‚¤
OPENAI_API_KEY=                          # OpenAI API í‚¤

# A2A Orchestration
NEXT_PUBLIC_A2A_ORCHESTRATION_BASE_URL=  # A2A ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„œë²„ URL
                                         # ì˜ˆ: https://a2a-orchestration-dev.ainetwork.ai/api

# Storage
AINSPACE_STORAGE_REDIS_URL=              # Redis ì—°ê²° URL (ì˜ˆ: redis://localhost:6379)
AINSPACE_BLOB_READ_WRITE_TOKEN=          # Vercel Blob í† í°

# Blockchain
NEXT_PUBLIC_AGENT_CONTRACT_ADDRESS=      # ì—ì´ì „íŠ¸ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ
NEXT_PUBLIC_ONCHAINKIT_API_KEY=          # OnchainKit API í‚¤
NEXT_PUBLIC_ONCHAINKIT_PROJECT_NAME=     # í”„ë¡œì íŠ¸ëª… (ì˜ˆ: AINSPACE)
NEXT_PUBLIC_ONCHAINKIT_PROJECT_DESCRIPTION= # í”„ë¡œì íŠ¸ ì„¤ëª…

# App URLs & Meta
NEXT_PUBLIC_URL=                         # ì•± ë°°í¬ URL
NEXT_PUBLIC_API_BASE_URL=                # API ê¸°ë³¸ URL
NEXT_PUBLIC_APP_OG_IMAGE=                # OG ì´ë¯¸ì§€ URL
NEXT_PUBLIC_APP_ICON=                    # ì•± ì•„ì´ì½˜ URL
NEXT_PUBLIC_SPLASH_IMAGE=                # ìŠ¤í”Œë˜ì‹œ ì´ë¯¸ì§€
NEXT_PUBLIC_SPLASH_BACKGROUND_COLOR=     # ìŠ¤í”Œë˜ì‹œ ë°°ê²½ìƒ‰
NEXT_PUBLIC_ENV=                         # í™˜ê²½ (production/development)
NEXT_PUBLIC_NODE_ENV=                    # Node í™˜ê²½

# Sentry
SENTRY_DSN=                              # Sentry DSN
SENTRY_AUTH_TOKEN=                       # Sentry ì¸ì¦ í† í°
```

### ì„¤ì¹˜ ë° ì‹¤í–‰

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
yarn install

# ê°œë°œ ì„œë²„ ì‹œì‘
yarn dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ
yarn build

# í”„ë¡œë•ì…˜ ì„œë²„ ì‹œì‘
yarn start

# ë¦°íŠ¸
yarn lint
```

---

## 5. ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Client (Browser)                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    RootLayout                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚  Providers (Wagmi â†’ QueryClient â†’ MapData â†’ OCK) â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  AuthGuard (ì›”ë › ì—°ê²° ê²€ì¦)                â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Page (/ or /login)              â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ MapTab   â”‚Agent â”‚Build â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ Tab  â”‚ Tab  â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â”‚Tile  â”‚ â”‚      â”‚      â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â”‚Map   â”‚ â”‚      â”‚      â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â”‚Canvasâ”‚ â”‚      â”‚      â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚      â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ ChatBox  â”‚      â”‚      â”‚     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Footer (íƒ­ ë„¤ë¹„ê²Œì´ì…˜)           â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Zustand Stores â”€â”€â†’ useUIStore, useGameStateStore, useAgentStoreâ”‚
â”‚                     useThreadStore, useBuildStore, useChatStore  â”‚
â”‚                     useMapStore                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ fetch / SSE
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Next.js API Routes                           â”‚
â”‚  /api/agents, /api/agent-chat, /api/threads,                  â”‚
â”‚  /api/thread-message, /api/thread-stream, /api/custom-tiles   â”‚
â”‚  /api/position, /api/commentary, ...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Redis     â”‚ â”‚ A2A Orch.  â”‚ â”‚  External APIs   â”‚
â”‚ (ë°ì´í„° ì €ì¥)â”‚ â”‚  Server    â”‚ â”‚ Gemini / OpenAI  â”‚
â”‚              â”‚ â”‚ (ì—ì´ì „íŠ¸  â”‚ â”‚ Firebase         â”‚
â”‚              â”‚ â”‚  ì˜¤ì¼€ìŠ¤íŠ¸  â”‚ â”‚ Vercel Blob      â”‚
â”‚              â”‚ â”‚  ë ˆì´ì…˜)   â”‚ â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° íë¦„ ìš”ì•½

1. **ì‚¬ìš©ì â†’ AuthGuard**: ì›”ë › ì—°ê²° ê²€ì¦ í›„ ë©”ì¸ í˜ì´ì§€ ë˜ëŠ” ë¡œê·¸ì¸ ë¦¬ë‹¤ì´ë ‰íŠ¸
2. **ë©”ì¸ í˜ì´ì§€ â†’ Zustand Stores**: ì»´í¬ë„ŒíŠ¸ê°€ storeë¥¼ êµ¬ë…í•˜ê³  ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸
3. **ì»´í¬ë„ŒíŠ¸ â†’ API Routes**: fetch í˜¸ì¶œë¡œ ì„œë²„ì™€ í†µì‹ 
4. **API Routes â†’ Redis**: ì—ì´ì „íŠ¸, íƒ€ì¼, ìœ„ì¹˜, ìŠ¤ë ˆë“œ ë°ì´í„° ì˜ì†í™”
5. **API Routes â†’ A2A Orchestration**: ìŠ¤ë ˆë“œ ìƒì„±, ë©”ì‹œì§€ ì „ì†¡, ì—ì´ì „íŠ¸ ê´€ë¦¬
6. **SSE Stream**: ì‹¤ì‹œê°„ ë©”ì‹œì§€ë¥¼ thread-stream APIë¥¼ í†µí•´ ìˆ˜ì‹ 

---

## 6. ë¼ìš°íŒ… êµ¬ì¡°

### í˜ì´ì§€ ë¼ìš°íŠ¸

| ê²½ë¡œ | íŒŒì¼ | ì¸ì¦ | ì„¤ëª… |
|------|------|------|------|
| `/` | `app/page.tsx` | í•„ìš” | ë©”ì¸ ê²Œì„ ì¸í„°í˜ì´ìŠ¤ |
| `/login` | `app/login/page.tsx` | ë¶ˆí•„ìš” | ì›”ë › ì—°ê²° í˜ì´ì§€ |

### API ë¼ìš°íŠ¸ (19ê°œ)

| ê²½ë¡œ | ë©”ì„œë“œ | ì„¤ëª… |
|------|--------|------|
| `/api/agents` | GET, POST, PUT, DELETE | ì—ì´ì „íŠ¸ CRUD |
| `/api/agents/upload-image` | POST | ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ (Firebase Storage) |
| `/api/agent-chat` | POST | A2A SDKë¡œ ì—ì´ì „íŠ¸ì™€ ëŒ€í™” |
| `/api/agent-proxy` | POST | A2A ì¹´ë“œ URL í”„ë¡ì‹œ |
| `/api/agent-response` | POST | Gemini AI ì‘ë‹µ ìƒì„± |
| `/api/create-agent` | POST | AI í”„ë¡¬í”„íŠ¸ë¡œ ì—ì´ì „íŠ¸ ìƒì„±/ë°°í¬ |
| `/api/threads` | GET, POST | ìŠ¤ë ˆë“œ ëª©ë¡/ìƒì„± |
| `/api/threads/[id]` | GET, DELETE | ê°œë³„ ìŠ¤ë ˆë“œ ì¡°íšŒ/ì‚­ì œ |
| `/api/thread-message` | POST | ìŠ¤ë ˆë“œì— ë©”ì‹œì§€ ì „ì†¡ (ë°˜ê²½ ê¸°ë°˜ ì—ì´ì „íŠ¸ íƒìƒ‰) |
| `/api/thread-stream/[threadId]` | GET | SSE ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° í”„ë¡ì‹œ |
| `/api/custom-tiles` | GET, POST | ì»¤ìŠ¤í…€ íƒ€ì¼ CRUD |
| `/api/position` | GET, POST | í”Œë ˆì´ì–´ ìœ„ì¹˜ ì €ì¥/ì¡°íšŒ |
| `/api/commentary` | POST | Gemini ê²Œì„ í•´ì„¤ ìƒì„± |
| `/api/clear-layer1` | POST | ì¶©ëŒ ë ˆì´ì–´ ì´ˆê¸°í™” |
| `/api/convert-image` | POST | ì´ë¯¸ì§€ í¬ë§· ë³€í™˜ |
| `/api/convert-status` | POST | ìƒíƒœ ë°ì´í„° ë³€í™˜ |
| `/api/upload-tile` | POST | íƒ€ì¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ |
| `/api/test-agent` | - | ì—ì´ì „íŠ¸ í…ŒìŠ¤íŠ¸ |
| `/api/sentry-example-api` | - | Sentry í…ŒìŠ¤íŠ¸ |

---

## 7. ìƒíƒœ ê´€ë¦¬ (Zustand Stores)

ëª¨ë“  storeëŠ” Zustand v5ë¥¼ ì‚¬ìš©í•˜ë©° `src/stores/` ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜í•œë‹¤. `index.ts`ì—ì„œ í†µí•© exportí•œë‹¤.

### 7.1 useUIStore

**ì—­í• **: íƒ­ ë„¤ë¹„ê²Œì´ì…˜ UI ìƒíƒœ

```typescript
// src/stores/useUIStore.ts
export const FOOTER_HEIGHT = 73; // 72px + 1px border

interface UIState {
    activeTab: 'map' | 'thread' | 'build' | 'agent';
    setActiveTab: (tab: 'map' | 'thread' | 'build' | 'agent') => void;
}
```

- ê¸°ë³¸ê°’: `activeTab = 'map'`
- Footer ë†’ì´ ìƒìˆ˜ë„ ì—¬ê¸°ì„œ export

### 7.2 useGameStateStore

**ì—­í• **: í”Œë ˆì´ì–´ ìœ„ì¹˜, ë°©í–¥, ì´ë™ ìƒíƒœ

```typescript
interface GameState {
    worldPosition: { x: number; y: number };
    playerDirection: DIRECTION;
    isLoading: boolean;
    isAutonomous: boolean;
    recentMovements: string[];
    lastCommentary: string;
    lastMoveTime: number;
    isPlayerMoving: boolean;
}
```

### 7.3 useAgentStore

**ì—­í• **: A2A ì—ì´ì „íŠ¸ ëª©ë¡ ê´€ë¦¬

```typescript
// src/stores/useAgentStore.ts
interface AgentStore {
    agents: AgentState[];
    getAgentByName: (name: string) => AgentState | undefined;
    spawnAgent: (agent: AgentState) => void;      // ì¤‘ë³µ ì²´í¬ í›„ ì¶”ê°€
    removeAgent: (agentUrl: string) => void;
    updateAgentPosition: (agentUrl: string, x: number, y: number) => void;
    updateAgentCharacterImage: (agentUrl: string, imageUrl: string) => void;
    setAgents: (agents: AgentState[]) => void;
    updateAgent: (agentUrl: string, updates: Partial<AgentState>) => void;
}
```

- ì—ì´ì „íŠ¸ ì‹ë³„ì: `agentUrl` (ìœ ë‹ˆí¬)
- `spawnAgent`: ì´ë¯¸ ê°™ì€ `agentUrl`ì´ ìˆìœ¼ë©´ ë¬´ì‹œ

### 7.4 useThreadStore

**ì—­í• **: ëŒ€í™” ìŠ¤ë ˆë“œ ë° ë¸Œë¡œë“œìºìŠ¤íŠ¸ ìƒíƒœ

```typescript
// src/stores/useThreadStore.ts
interface BroadcastStatus {
    range: number;
    agentsReached: number;
    agentNames: string[];
}

interface ThreadState {
    threads: Thread[];
    currentThreadId: string | undefined;  // ê¸°ë³¸ê°’: '0'
    broadcastMessage: string;
    broadcastStatus: BroadcastStatus | null;

    setThreads, addThread, findThreadByName, findThreadById,
    updateThread, removeThread, setCurrentThreadId,
    setBroadcastMessage, setBroadcastStatus,
    clearBroadcastMessage, clearBroadcastStatusAfterDelay
}
```

### 7.5 useBuildStore

**ì—­í• **: ë§µ ë¹Œë”©, íƒ€ì¼ ê´€ë¦¬, ì¶©ëŒ ë§µ

```typescript
// src/stores/useBuildStore.ts
export interface ItemTileData {
    image: string;
    width: number;        // íƒ€ì¼ ë‹¨ìœ„
    height: number;       // íƒ€ì¼ ë‹¨ìœ„
    topLeftX: number;     // ë°°ì¹˜ ì‹œì‘ X ì¢Œí‘œ
    topLeftY: number;     // ë°°ì¹˜ ì‹œì‘ Y ì¢Œí‘œ
    isSecondaryTile?: boolean;  // top-left ì•µì»¤ê°€ ì•„ë‹Œ ë³´ì¡° íƒ€ì¼
}

export type TileLayers = {
    layer0: { [key: string]: string };                    // ì§€ë©´ ë ˆì´ì–´
    layer1: { [key: string]: string | ItemTileData };     // ì˜¤ë¸Œì íŠ¸ ë ˆì´ì–´ (ì¶©ëŒ)
    layer2: { [key: string]: string };                    // ìƒìœ„ ë ˆì´ì–´
};

interface BuildState {
    customTiles: TileLayers;           // í˜„ì¬ í¸ì§‘ ì¤‘ì¸ íƒ€ì¼ (draft)
    publishedTiles: TileLayers;        // ì„œë²„ì—ì„œ ë¡œë“œ/í¼ë¸”ë¦¬ì‹œëœ íƒ€ì¼
    selectedImage: string | null;
    buildMode: 'select' | 'paint';
    isPublishing: boolean;
    publishStatus: { type: 'success'|'error', message: string } | null;
    showCollisionMap: boolean;
    collisionMap: { [key: string]: boolean };  // "x,y" â†’ true

    // í•µì‹¬ ë©”ì„œë“œ
    updateCollisionMapFromImage: (imageSrc: string) => Promise<void>;
    isBlocked: (worldX: number, worldY: number) => boolean;
}
```

**ì¶©ëŒ ë§µ ìƒì„± ë¡œì§** (`updateCollisionMapFromImage`):
1. `/map/tiles/land_layer_1/tile_{row}_{col}.webp` ì´ë¯¸ì§€ë¥¼ 5x5 ê·¸ë¦¬ë“œë¡œ ë¡œë“œ
2. ê° ì´ë¯¸ì§€ íƒ€ì¼ì€ 840x840px, 21x21 ê²Œì„ íƒ€ì¼ í¬í•¨
3. Canvasì— ê·¸ë ¤ì„œ ê° ê²Œì„ íƒ€ì¼ ì˜ì—­ì˜ ë¶ˆíˆ¬ëª… í”½ì…€ ë¹„ìœ¨ ê³„ì‚°
4. **ë¶ˆíˆ¬ëª… ë¹„ìœ¨ >= 50%** ì´ë©´ í•´ë‹¹ ì¢Œí‘œë¥¼ ì¶©ëŒ íƒ€ì¼ë¡œ ë§ˆí‚¹

### 7.6 useChatStore

**ì—­í• **: ìŠ¤ë ˆë“œë³„ ì±„íŒ… ë©”ì‹œì§€, ì—ì´ì „íŠ¸ ë¡œë”© ìƒíƒœ

```typescript
// src/stores/useChatStore.ts
export interface ChatMessage {
    id: string;
    text: string;
    timestamp: Date;
    sender: 'user' | 'system' | 'ai';
    senderId?: string;
    threadId?: string;
}

export interface ThreadMessages {
    [threadId: string]: ChatMessage[];
}

interface ChatState {
    messages: ThreadMessages;
    loadingAgents: Set<string>;

    setMessages: (msgs: ChatMessage[] | updater, threadId?: string) => void;
    addMessage: (threadId: string, message: ChatMessage) => void;
    clearMessages: () => void;
    getMessagesByThreadId: (threadId: string) => ChatMessage[];
    setAgentLoading: (agentId: string, isLoading: boolean) => void;
    isAgentLoading: (agentId: string) => boolean;
}
```

### 7.7 useMapStore

**ì—­í• **: Tiled ë§µ ë°ì´í„°, íƒ€ì¼ì…‹ ë¦¬ì†ŒìŠ¤, ì¶©ëŒ íƒ€ì¼

```typescript
// src/stores/useMapStore.ts
type TiledMap = {
    tilewidth: number;
    tileheight: number;
    width: number;
    height: number;
    layers: TiledLayer[];
    tilesets: TiledTileset[];
};

type TilesetResource = {
    firstgid: number;
    image: HTMLImageElement;
    columns: number;
    tilecount: number;
    tilewidth: number;
    tileheight: number;
    imageScale?: number;
};

interface MapState {
    mapData: TiledMap | null;
    tilesets: TilesetResource[];
    collisionTiles: Array<{ x: number; y: number }>;
    mapStartPosition: { x: number; y: number };
    mapEndPosition: { x: number; y: number };
    isLoaded: boolean;

    isCollisionTile: (x: number, y: number) => boolean;  // collisionTiles.some()
}
```

### Store í†µí•© Export

```typescript
// src/stores/index.ts
export { useUIStore, FOOTER_HEIGHT } from './useUIStore';
export { useThreadStore } from './useThreadStore';
export { useBuildStore } from './useBuildStore';
export { useAgentStore } from './useAgentStore';
export { useGameStateStore } from './useGameStateStore';
export { useChatStore } from './useChatStore';

export type { Thread } from '@/types/thread';
export type { TileLayers } from './useBuildStore';
export type { ChatMessage } from './useChatStore';
```

---

## 8. í•µì‹¬ ë°ì´í„° íƒ€ì…

### Thread

```typescript
// src/types/thread.ts
export interface Thread {
    id: string;
    threadName: string;
    agentNames: string[];
    agentComboId: string;        // SHA-256 í•´ì‹œ (ì—ì´ì „íŠ¸ ì¡°í•© ì‹ë³„)
    createdAt: string;
    lastMessageAt: string;
    hasUnplacedAgents?: boolean;   // ë§µì— ë°°ì¹˜ë˜ì§€ ì•Šì€ ì—ì´ì „íŠ¸ í¬í•¨ ì—¬ë¶€
    unplacedAgentNames?: string[];
}

export interface ThreadInOrchestration extends Omit<Thread, 'hasUnplacedAgents' | 'unplacedAgentNames'> {
    userId: string;
}
```

### Agent ê´€ë ¨ íƒ€ì…

```typescript
// src/lib/agent.ts
export interface AgentInfo {
    id: string;
    name: string;
    agentUrl: string;
    skills: AgentSkill[];      // @a2a-js/sdk
}

export interface AgentWorldState {
    x: number;
    y: number;
    behavior: string;
    color: string;
    direction?: DIRECTION;
    lastMoved?: number;
    moveInterval?: number;
    isMoving?: boolean;
}

export interface AgentVisualState {
    spriteUrl?: string;
    spriteHeight?: number;
    spriteWidth?: number;
}

export interface AgentState extends AgentInfo, AgentWorldState, AgentVisualState {}

// DB ì €ì¥ìš© (ë°©í–¥, ì´ë™ ìƒíƒœ ì œì™¸)
export interface AgentStateForDB extends Omit<AgentWorldState, 'direction' | 'lastMoved' | 'isMoving'> {}
```

### Redis ì €ì¥ íƒ€ì…

```typescript
// src/lib/redis.ts
export interface StoredAgent {
    url: string;
    card: AgentCard;           // @a2a-js/sdk
    state: AgentStateForDB;
    spriteUrl?: string;
    spriteHeight?: number;
    isPlaced: boolean;
    creator: string;
    timestamp: number;
}

export interface PlayerPosition {
    x: number;
    y: number;
    lastUpdated: string;       // ISO ë‚ ì§œ
}

export interface CustomTilesData {
    tiles: TileLayers;
    lastUpdated: string;
}
```

### SSE ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸

```typescript
// src/lib/a2aOrchestration.ts
export interface StreamEvent {
    type: 'connected' | 'message' | 'block' | 'error';
    data: {
        data?: {
            id?: string;
            speaker?: string;
            content?: string;
            timestamp?: number;
            replyTo?: string;
            status?: 'accepted' | 'dropped';
        };
        next?: { id: string; name: string };
        content?: string;
        message?: string;
        sender?: string;
        agentName?: string;
        speaker?: string;
        summary?: string;
        error?: string;
        clientId?: string;
    };
}
```

---

## 9. Provider ê³„ì¸µ êµ¬ì¡°

```typescript
// src/providers/Providers.tsx
// ì¤‘ì²© ìˆœì„œ:
WagmiProvider           // 1. ë¸”ë¡ì²´ì¸ ì›”ë › ì—°ê²°
  â†’ QueryClientProvider // 2. TanStack Query (staleTime: 60s, retry: 1)
    â†’ MapDataProvider   // 3. ë§µ ë°ì´í„° Context
      â†’ OnchainKitProvider  // 4. Base ì²´ì¸ + MiniKit
        â†’ children
```

### ì£¼ìš” ë™ì‘

1. **ë§ˆìš´íŠ¸ ì‹œ** `mounted` ìƒíƒœë¥¼ trueë¡œ ì„¤ì • (hydration ë³´í˜¸)
2. **ì›”ë › ì²´ì¸ ìë™ ì „í™˜**: `wallet_switchEthereumChain`ìœ¼ë¡œ Base ì²´ì¸(`0x2105`)ìœ¼ë¡œ ì „í™˜
3. **ê¸°ë³¸ ì—ì´ì „íŠ¸ ì´ˆê¸°í™”**: `initializeDefaultAgents()` í˜¸ì¶œ (í˜„ì¬ ë¹„í™œì„±í™”ë¨)

### OnchainKit ì„¤ì •

```typescript
{
    apiKey: NEXT_PUBLIC_ONCHAINKIT_API_KEY,
    chain: base,
    miniKit: { enabled: true, autoConnect: true },
    config: {
        appearance: {
            mode: 'auto',
            theme: 'mini-app-theme'
        },
        wallet: { display: 'classic' }
    }
}
```

### Wagmi ì„¤ì •

```typescript
// src/lib/wagmi-config.ts
createConfig({
    chains: [base, baseSepolia, mainnet],
    connectors: [
        coinbaseWallet({
            appName: NEXT_PUBLIC_ONCHAINKIT_PROJECT_NAME || 'Base MiniApp',
            preference: 'all'
        })
    ],
    transports: {
        [base.id]: http(),
        [baseSepolia.id]: http(),
        [mainnet.id]: http(),
    },
    ssr: true
});
```

---

## 10. ì¸ì¦ ì‹œìŠ¤í…œ (AuthGuard)

### ë™ì‘ ì›ë¦¬

```
[ì‚¬ìš©ì ì ‘ì†]
      â”‚
      â–¼
 AuthGuard (layout.tsxì˜ children ë˜í•‘)
      â”‚
      â”œâ”€â”€ pathname === '/' â†’ ì¸ì¦ í•„ìš”
      â”‚     â”‚
      â”‚     â”œâ”€â”€ isConnecting || !isHydrated â†’ ë¡œë”© ìŠ¤í”¼ë„ˆ í‘œì‹œ
      â”‚     â”‚
      â”‚     â”œâ”€â”€ !isConnected â†’ /loginìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
      â”‚     â”‚   â””â”€â”€ redirectAttemptedRefë¡œ ë¬´í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°©ì§€
      â”‚     â”‚
      â”‚     â””â”€â”€ isConnected â†’ children ë Œë”ë§
      â”‚
      â””â”€â”€ pathname !== '/' â†’ children ë°”ë¡œ ë Œë”ë§
```

### Hydration ì²˜ë¦¬

1. `isMounted` â†’ useEffectë¡œ í´ë¼ì´ì–¸íŠ¸ ë§ˆìš´íŠ¸ í™•ì¸
2. `isHydrated` â†’ wagmiì˜ `isConnecting`ì´ ëë‚˜ê³  100ms í›„ true
3. ë‘ ì¡°ê±´ ëª¨ë‘ ë§Œì¡±í•´ì•¼ ì¸ì¦ ì²´í¬ ì‹œì‘

### Sentry ì¶”ì 

- ëª¨ë“  ìƒíƒœ ë³€í™”ë¥¼ breadcrumbìœ¼ë¡œ ê¸°ë¡
- ë¦¬ë‹¤ì´ë ‰íŠ¸ ë°œìƒ ì‹œ `captureMessage`
- ë¬´í•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ê°ì§€ ì‹œ warning ë ˆë²¨ ë³´ê³ 

---

## 11. í˜ì´ì§€ë³„ ìƒì„¸ êµ¬í˜„

### 11.1 ë¡œê·¸ì¸ í˜ì´ì§€ (`/login`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      #B1E1FF ë°°ê²½         â”‚
â”‚                           â”‚
â”‚     [AINSpace ë¡œê³ ]       â”‚
â”‚                           â”‚
â”‚   [Wallet Login ë²„íŠ¼]     â”‚ â† Coinbase OnchainKit Signature
â”‚                           â”‚
â”‚     [AI Network ë¡œê³ ]     â”‚
â”‚                           â”‚
â”‚   [ë¡œê·¸ì¸ ë°°ê²½ ì´ë¯¸ì§€]     â”‚ â† fixed, bottom
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ë¡œì§**:
1. `Signature` ì»´í¬ë„ŒíŠ¸ë¡œ ë©”ì‹œì§€ ì„œëª… ìš”ì²­: `"Welcome to the AINSpace MiniApp!\n\nNonce: {timestamp}"`
2. ì„œëª… ì„±ê³µ í›„ useEffectì—ì„œ `isConnected` ê°ì§€ â†’ `router.push('/')` ë¦¬ë‹¤ì´ë ‰íŠ¸
3. ì´ë¯¸ ì—°ê²°ëœ ìƒíƒœë©´ ë°”ë¡œ í™ˆìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
4. ë²„íŠ¼ì€ 100ms í›„ fade-in ì• ë‹ˆë©”ì´ì…˜

### 11.2 ë©”ì¸ ê²Œì„ í˜ì´ì§€ (`/`)

íƒ­ ê¸°ë°˜ SPA. ëª¨ë“  íƒ­ ì»´í¬ë„ŒíŠ¸ê°€ ë™ì‹œì— ë§ˆìš´íŠ¸ë˜ì§€ë§Œ `isActive` propìœ¼ë¡œ ê°€ì‹œì„± ì œì–´.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MapTab / AgentTab /    â”‚ â”‚  â† íƒ­ ì½˜í…ì¸  (absolute, inset-0)
â”‚  â”‚  TempBuildTab           â”‚ â”‚     padding-bottom: 73px
â”‚  â”‚                         â”‚ â”‚
â”‚  â”‚  (Canvas + Joystick +   â”‚ â”‚
â”‚  â”‚   ChatOverlay)          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [Agent] [Map] [Build]   â”‚ â”‚  â† Footer (fixed bottom, 72px)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì´ˆê¸°í™” ì‹œí€€ìŠ¤** (`page.tsx`ì˜ useEffectë“¤):

1. **Farcaster í”„ë ˆì„ ë ˆë””**: `setFrameReady()` + `sdk.actions.ready()`
2. **Eruda ë””ë²„ê±°**: ê°œë°œí™˜ê²½ì—ì„œë§Œ ë™ì  import
3. **ì¶©ëŒ ë§µ ì´ˆê¸°í™”**: `/map/land_layer_1.webp` ì´ë¯¸ì§€ ë¶„ì„ìœ¼ë¡œ collision map ìƒì„±
4. **ì»¤ìŠ¤í…€ íƒ€ì¼ ë¡œë“œ**: userIdë¡œ ì„œë²„ì—ì„œ published tiles ê°€ì ¸ì˜¤ê¸°
5. **ë°°í¬ëœ ì—ì´ì „íŠ¸ ë¡œë“œ**: Redisì—ì„œ `isPlaced: true`ì¸ ì—ì´ì „íŠ¸ ë³µì›
6. **ì—ì´ì „íŠ¸ ì´ë™ ì‹œìŠ¤í…œ**: 100ms ê°„ê²© setInterval (í˜„ì¬ `ENABLE_AGENT_MOVEMENT = false`ë¡œ ë¹„í™œì„±í™”)

**ë°°í¬ ì¡´ (Deploy Zone)**:
```typescript
const ALLOWED_DEPLOY_ZONE = [{
    startX: -10, startY: -19,
    endX: 9, endY: 1
}];
```

---

## 12. ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

### 12.1 MapTab

**ì—­í• **: ê²Œì„ ë§µ ë””ìŠ¤í”Œë ˆì´, í”Œë ˆì´ì–´ ì´ë™, ì±„íŒ… ì˜¤ë²„ë ˆì´

**ì£¼ìš” ê¸°ëŠ¥**:
- TileMap ë Œë”ë§ (ìº”ë²„ìŠ¤ ê¸°ë°˜)
- í‚¤ë³´ë“œ ì´ë™: WASD / ë°©í–¥í‚¤
- ëª¨ë°”ì¼ ì¡°ì´ìŠ¤í‹±: `react-joystick-component`
- ì±„íŒ… ì˜¤ë²„ë ˆì´: ChatBoxOverlay
- HUD í† ê¸€: `Ctrl+H`ë¡œ ì „ì²´ UI ìˆ¨ê¸°ê¸°/í‘œì‹œ
- ìœ„ì¹˜ ë¦¬ì…‹: `Ctrl+R`ë¡œ ì›ì  ë³µê·€

### 12.2 TileMap (í•µì‹¬ ë Œë”ëŸ¬)

**ì—­í• **: Canvas ê¸°ë°˜ 2D íƒ€ì¼ë§µ ë Œë”ë§

**ë Œë”ë§ ìˆœì„œ**:
1. **Layer 0**: ì§€ë©´ íƒ€ì¼ (ìº”ë²„ìŠ¤ drawImage)
2. **Published Tiles (layer0)**: ì„œë²„ì—ì„œ ë¡œë“œëœ ì»¤ìŠ¤í…€ ì§€ë©´ íƒ€ì¼
3. **Custom Tiles (layer0)**: ë¡œì»¬ í¸ì§‘ ì¤‘ì¸ ì§€ë©´ íƒ€ì¼
4. **Layer 1**: ì˜¤ë¸Œì íŠ¸ íƒ€ì¼ (ì¶©ëŒ ëŒ€ìƒ)
5. **Published/Custom Tiles (layer1)**: ë©€í‹°íƒ€ì¼ ì•„ì´í…œ í¬í•¨
6. **Layer 2**: ìƒìœ„ ë ˆì´ì–´
7. **ì—ì´ì „íŠ¸**: ìŠ¤í”„ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ (SpriteAnimator) ë˜ëŠ” ìƒ‰ìƒ ì›
8. **í”Œë ˆì´ì–´**: ìŠ¤í”„ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ ë˜ëŠ” íŒŒë€ ì›
9. **ì¶©ëŒ ë§µ ì˜¤ë²„ë ˆì´**: ë””ë²„ê·¸ ì‹œ ë°˜íˆ¬ëª… ë¹¨ê°„ìƒ‰ í‘œì‹œ
10. **ì—ì´ì „íŠ¸ ì´ë¦„ ë¼ë²¨**: ìº”ë²„ìŠ¤ ìœ„ HTML divë¡œ ì˜¤ë²„ë ˆì´

**ì¤Œ ì œì–´**: 0.5x ~ 2.0x (ë²„íŠ¼ UI)

**í„°ì¹˜/ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸**: ë¹Œë“œ ëª¨ë“œì—ì„œ íƒ€ì¼ í˜ì¸íŒ… ì§€ì›

### 12.3 AgentTab

**ì—­í• **: A2A ì—ì´ì „íŠ¸ ì„í¬íŠ¸/ê´€ë¦¬

**êµ¬ì„±**:
```
AgentTab
â”œâ”€â”€ ImportAgentSection     # URL ì…ë ¥ â†’ A2A ì¹´ë“œ ì„í¬íŠ¸
â”œâ”€â”€ CreateAgentSection     # A2A Builder ë§í¬ (ì™¸ë¶€ ì´ë™)
â””â”€â”€ ImportedAgentList      # ì„í¬íŠ¸ëœ ì—ì´ì „íŠ¸ ëª©ë¡
    â””â”€â”€ ImportedAgentCard  # ê°œë³„ ì—ì´ì „íŠ¸ ì¹´ë“œ
        â”œâ”€â”€ ì—ì´ì „íŠ¸ í”„ë¡œí•„ (ìŠ¤í”„ë¼ì´íŠ¸)
        â”œâ”€â”€ Place/Unplace ë²„íŠ¼
        â”œâ”€â”€ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë²„íŠ¼
        â””â”€â”€ ì‚­ì œ ë²„íŠ¼
```

**ì—ì´ì „íŠ¸ ì„í¬íŠ¸ í”Œë¡œìš°**:
1. A2A ì¹´ë“œ URL ì…ë ¥ â†’ `/api/agent-proxy` í˜¸ì¶œ â†’ ì¹´ë“œ ì •ë³´ íšë“
2. Redisì— ì—ì´ì „íŠ¸ ë“±ë¡ (`/api/agents` POST)
3. "Place" í´ë¦­ â†’ ë°°í¬ì¡´ì—ì„œ ë¹ˆ ìœ„ì¹˜ íƒìƒ‰ â†’ ì—ì´ì „íŠ¸ ìŠ¤í°

**í† í° í™€ë” ê²€ì¦** (AgentTab):
- AIN, sAIN, Mini Egg NFT ì”ì•¡ í™•ì¸
- í™€ë”ë§Œ íŠ¹ì • ê¸°ëŠ¥ ì ‘ê·¼ ê°€ëŠ¥

### 12.4 TempBuildTab

**ì—­í• **: ë§µì— ì•„ì´í…œ ë°°ì¹˜

**ê¸°ëŠ¥**:
- 6ì¢… ì•„ì´í…œ ì„ íƒ (ì¸ë±ìŠ¤ 0~5)
- ë©€í‹°íƒ€ì¼ ì•„ì´í…œ ë°°ì¹˜ (collision ìë™ ì„¤ì •)
- ì•„ì´í…œ ì‚­ì œ
- ì¶©ëŒ ë§µ ì‹œê°í™”
- Publish â†’ ì„œë²„ ì €ì¥

### 12.5 ChatBox (í•µì‹¬ ì±„íŒ…)

**ì—­í• **: ì—ì´ì „íŠ¸ì™€ì˜ ëŒ€í™” ì¸í„°í˜ì´ìŠ¤

**í•µì‹¬ ê¸°ëŠ¥**:
- **ìŠ¤ë ˆë“œ ê¸°ë°˜ ëŒ€í™”**: ì—ì´ì „íŠ¸ ì¡°í•©ë³„ ìŠ¤ë ˆë“œ ìë™ ìƒì„±/ê´€ë¦¬
- **@ë©˜ì…˜**: ì…ë ¥ ì¤‘ `@`ë¡œ ì—ì´ì „íŠ¸ ì¶”ì²œ ëª©ë¡ í‘œì‹œ
- **ë¸Œë¡œë“œìºìŠ¤íŠ¸**: ë°˜ê²½ ë‚´ ì—ì´ì „íŠ¸ì—ê²Œ ë©”ì‹œì§€ ì „íŒŒ
- **SSE ìŠ¤íŠ¸ë¦¬ë°**: ì‹¤ì‹œê°„ ì—ì´ì „íŠ¸ ì‘ë‹µ ìˆ˜ì‹ 
- **A2A Orchestration**: ìŠ¤ë ˆë“œ ìƒì„± â†’ ì—ì´ì „íŠ¸ ì¶”ê°€ â†’ ë©”ì‹œì§€ ì „ì†¡ â†’ ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ 

**ê´€ë¦¬ì ëª…ë ¹ì–´**:
- `"show me grid"`: ê·¸ë¦¬ë“œ í‘œì‹œ
- `"exit"`: ì¢…ë£Œ
- `"clear items"`: ì•„ì´í…œ ì´ˆê¸°í™”

**ë©”ì‹œì§€ ì „ì†¡ í”Œë¡œìš°**:
1. ë©”ì‹œì§€ ì…ë ¥ â†’ ë¸Œë¡œë“œìºìŠ¤íŠ¸ ë°˜ê²½ ë‚´ ì—ì´ì „íŠ¸ íƒìƒ‰
2. ì—ì´ì „íŠ¸ ì¡°í•©ìœ¼ë¡œ ê¸°ì¡´ ìŠ¤ë ˆë“œ ê²€ìƒ‰ (SHA-256 í•´ì‹œ)
3. ì—†ìœ¼ë©´ ìƒˆ ìŠ¤ë ˆë“œ ìƒì„± (A2A Orchestration)
4. ìŠ¤ë ˆë“œì— ì—ì´ì „íŠ¸ ì¶”ê°€ â†’ ë©”ì‹œì§€ ì „ì†¡
5. SSEë¡œ ì—ì´ì „íŠ¸ ì‘ë‹µ ì‹¤ì‹œê°„ ìˆ˜ì‹ 

### 12.6 ChatBoxOverlay

**ì—­í• **: MapTab ìœ„ì— ì±„íŒ… UI ì˜¤ë²„ë ˆì´

**êµ¬ì„±**:
```
ChatBoxOverlay
â”œâ”€â”€ ThreadListLeftDrawer   # ì¢Œì¸¡ ìŠ¤ë ˆë“œ ëª©ë¡ ë“œë¡œì–´
â””â”€â”€ ChatBottomDrawer       # í•˜ë‹¨ ì±„íŒ… ë“œë¡œì–´
    â””â”€â”€ ChatBox            # ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
```

- ì‹œíŠ¸ ì—´ë¦¼ ìƒíƒœì— ë”°ë¼ ì¡°ì´ìŠ¤í‹± ê°€ì‹œì„± ì œì–´

### 12.7 Footer

**ì—­í• **: í•˜ë‹¨ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ (72px + 1px border = 73px)

| íƒ­ | ì•„ì´ì½˜ | ë¼ë²¨ |
|----|--------|------|
| Agent | `tab_icon_agent.svg` | Agent |
| Map | `tab_icon_map.svg` | Map |
| Build | `tab_icon_build.svg` | Build |

- ë°°ê²½: ê²€ì •(#000) / ë¹„í™œì„± íƒ­: `#424049`
- `Z_INDEX_OFFSETS.UI = 1000`ìœ¼ë¡œ ìµœìƒë‹¨ ë ˆì´ì–´
- HUD Off ì‹œ ìˆ¨ê¹€ ì²˜ë¦¬

---

## 13. ê²Œì„ ì‹œìŠ¤í…œ ìƒì„¸

### 13.1 ê²Œì„ ìƒìˆ˜

```typescript
// src/constants/game.ts
TILE_SIZE = 40              // íƒ€ì¼ í¬ê¸° (px)
MAP_SIZE_PIXELS = 4200      // ë§µ ì „ì²´ í¬ê¸° (px)
MAP_TILES = 105             // ë§µ íƒ€ì¼ ìˆ˜ (105x105)
MAP_WIDTH = 16              // ë·°í¬íŠ¸ ê°€ë¡œ íƒ€ì¼ ìˆ˜
MAP_HEIGHT = 12             // ë·°í¬íŠ¸ ì„¸ë¡œ íƒ€ì¼ ìˆ˜
VIEW_RADIUS = 6             // ê°€ì‹œ ë°˜ê²½ (íƒ€ì¼)
BROADCAST_RADIUS = 5        // ë¸Œë¡œë“œìºìŠ¤íŠ¸ ë°˜ê²½ (íƒ€ì¼)
AGENT_RESPONSE_DISTANCE = 2 // ì—ì´ì „íŠ¸ ì‘ë‹µ ê±°ë¦¬ (íƒ€ì¼)
MIN_MOVE_INTERVAL = 150     // ìµœì†Œ ì´ë™ ê°„ê²© (ms)
INITIAL_PLAYER_POSITION = { x: 0, y: 0 }
ENABLE_AGENT_MOVEMENT = false  // ì—ì´ì „íŠ¸ ìë™ ì´ë™ ë¹„í™œì„±í™”

enum DIRECTION { UP, DOWN, LEFT, RIGHT, STOP }
```

### 13.2 Z-Index ì²´ê³„

```typescript
// src/constants/common.ts
Z_INDEX_OFFSETS = {
    DEFAULT: 0,    // ê¸°ë³¸
    GAME: 500,     // ê²Œì„ ìº”ë²„ìŠ¤
    UI: 1000       // UI ìš”ì†Œ (Footer, Overlay ë“±)
}
```

### 13.3 ì¶©ëŒ ê°ì§€ ì‹œìŠ¤í…œ

**3ë‹¨ê³„ ì¶©ëŒ ì²´í¬**:

1. **ë§µ ê²½ê³„ ì²´í¬**: `mapStartPosition` ~ `mapEndPosition` ë²”ìœ„
2. **íƒ€ì¼ ì¶©ëŒ ì²´í¬**:
   - `useMapStore.isCollisionTile(x, y)`: Tiled ë§µì˜ collision layer
   - `useBuildStore.isBlocked(x, y)`: ì´ë¯¸ì§€ ë¶„ì„ ê¸°ë°˜ collision map
3. **ì—ì´ì „íŠ¸/í”Œë ˆì´ì–´ ì¶©ëŒ**: í•´ë‹¹ ì¢Œí‘œì— ë‹¤ë¥¸ ì—ì´ì „íŠ¸ë‚˜ í”Œë ˆì´ì–´ê°€ ìˆëŠ”ì§€ í™•ì¸

### 13.4 ì—ì´ì „íŠ¸ ì´ë™ ì‹œìŠ¤í…œ

`page.tsx`ì—ì„œ 100ms ê°„ê²© `setInterval`ë¡œ êµ¬í˜„ (í˜„ì¬ ë¹„í™œì„±í™”):

```
ë§¤ 100ms:
  ê° ì—ì´ì „íŠ¸ì— ëŒ€í•´:
    1. moveInterval ê²½ê³¼ í™•ì¸ (600~1000ms ëœë¤)
    2. 4ë°©í–¥ ì…”í”Œ â†’ ìˆœì„œëŒ€ë¡œ ìœ íš¨í•œ ì´ë™ ì‹œë„
    3. ì´ë™ ê°€ëŠ¥:
       - ë§µ ê²½ê³„ ë‚´
       - í”Œë ˆì´ì–´/ë‹¤ë¥¸ ì—ì´ì „íŠ¸ì™€ ë¯¸ì¶©ëŒ
       - layer1 ì¶©ëŒ ë§µì— ë¯¸ì°¨ë‹¨
    4. ì´ë™ ì„±ê³µ ì‹œ:
       - ìœ„ì¹˜ ì—…ë°ì´íŠ¸ + direction ì„¤ì • + isMoving = true
       - 500ms í›„ isMoving = false (ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ)
    5. ì´ë™ ë¶ˆê°€ ì‹œ: lastMovedë§Œ ê°±ì‹  (stuck ë°©ì§€)
```

### 13.5 ì—ì´ì „íŠ¸ ìŠ¤í° ìœ„ì¹˜ íƒìƒ‰

**Zone ê¸°ë°˜ íƒìƒ‰** (`findAvailableSpawnPositionByZone`):
- í—ˆìš© ì¡´ ë‚´ ëª¨ë“  ì¢Œí‘œë¥¼ ì…”í”Œ
- ìœ íš¨í•œ ìœ„ì¹˜ê°€ ë‚˜ì˜¬ ë•Œê¹Œì§€ ìˆœíšŒ

**Radius ê¸°ë°˜ íƒìƒ‰** (`findAvailableSpawnPositionByRadius`):
- ì¤‘ì‹¬ì ì—ì„œ ë°˜ê²½ 1ë¶€í„° `BROADCAST_RADIUS`ê¹Œì§€ í™•ì¥
- ê° ë°˜ê²½ì˜ ë‘˜ë ˆ(perimeter) ì¢Œí‘œ ì…”í”Œ í›„ ìœ íš¨ ìœ„ì¹˜ íƒìƒ‰

---

## 14. ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ

### 14.1 ì—ì´ì „íŠ¸ í´ë˜ìŠ¤ ê³„ì¸µ

```
BaseAgent (abstract)
â”œâ”€â”€ ExplorerAgent      # type: 'random' - í•­ìƒ ì‘ë‹µ
â”œâ”€â”€ PatrolAgent        # type: 'patrol' - í•­ìƒ ì‘ë‹µ
â”œâ”€â”€ WandererAgent      # type: 'explorer' - í•­ìƒ ì‘ë‹µ
â””â”€â”€ A2AAgent           # type: 'A2A Agent' - A2A í”„ë¡œí† ì½œ ê¸°ë°˜
```

### 14.2 BaseAgent í•µì‹¬ ë¡œì§

**ë©”ì‹œì§€ ì‘ë‹µ íŒë‹¨**:
1. **Chebyshev ê±°ë¦¬ ê³„ì‚°**: `max(|dx|, |dy|)` (ëŒ€ê°ì„  ì´ë™ í—ˆìš©)
2. ë©˜ì…˜ë˜ì§€ ì•Šì•˜ê³  ê±°ë¦¬ > `AGENT_RESPONSE_DISTANCE(2)` â†’ ë¬´ì‹œ
3. ìŠ¤ë ˆë“œ ì°¸ì—¬ ì—¬ë¶€ í™•ì¸:
   - ìŠ¤ë ˆë“œ ë©”ì‹œì§€: ìŠ¤ë ˆë“œ ë©¤ë²„ì´ê±°ë‚˜ ë©˜ì…˜ë˜ì–´ì•¼ ì‘ë‹µ
   - ë©˜ì…˜ìœ¼ë¡œ ìƒˆ ìŠ¤ë ˆë“œ ì°¸ì—¬ ìë™ ê°€ì…
4. ì‘ë‹µ ìƒì„±: `/api/agent-response` (Gemini API)

**ë¡œë”© ìƒíƒœ ê´€ë¦¬**:
- API í˜¸ì¶œ ì „: `useChatStore.setAgentLoading(id, true)`
- ì‘ë‹µ ìˆ˜ì‹ /ì—ëŸ¬ í›„: `useChatStore.setAgentLoading(id, false)`

### 14.3 A2AAgent íŠ¹ìˆ˜ ë™ì‘

- `/api/agent-chat`ì„ í†µí•´ A2A SDKë¡œ ì™¸ë¶€ ì—ì´ì „íŠ¸ì™€ í†µì‹ 
- ë©”ì‹œì§€ í¬ë§·: `[From player at (x, y)]: {content}`
- ì‘ë‹µ ê±°ë¦¬ ì œí•œ: 10 íƒ€ì¼
- ì‘ë‹µ ì§€ì—°: 0.5~1.5ì´ˆ ëœë¤

### 14.4 ì—ì´ì „íŠ¸ íŒ©í† ë¦¬

```typescript
function createAgent(type: string, initialState: AgentState): BaseAgent {
    switch (type) {
        case 'random':      return new ExplorerAgent(initialState);
        case 'patrol':      return new PatrolAgent(initialState);
        case 'explorer':    return new WandererAgent(initialState);
        case 'A2A Agent':   return new A2AAgent(initialState);
    }
}
```

---

## 15. ë§µ ë¹Œë”© ì‹œìŠ¤í…œ

### 15.1 íƒ€ì¼ ë ˆì´ì–´ êµ¬ì¡°

```
Layer 2 (layer2)  â† ìµœìƒìœ„ (ë””ì½”ë ˆì´ì…˜)
Layer 1 (layer1)  â† ì˜¤ë¸Œì íŠ¸ (ì¶©ëŒ ëŒ€ìƒ, ItemTileData ì§€ì›)
Layer 0 (layer0)  â† ì§€ë©´ (ë°”ë‹¥ í…ìŠ¤ì²˜)
```

### 15.2 ë©€í‹°íƒ€ì¼ ì•„ì´í…œ

`layer1`ì— ë°°ì¹˜ë˜ëŠ” ì•„ì´í…œì€ ì—¬ëŸ¬ íƒ€ì¼ì„ ì°¨ì§€í•  ìˆ˜ ìˆë‹¤:

```typescript
interface ItemTileData {
    image: string;           // ì´ë¯¸ì§€ URL
    width: number;           // ê°€ë¡œ íƒ€ì¼ ìˆ˜
    height: number;          // ì„¸ë¡œ íƒ€ì¼ ìˆ˜
    topLeftX: number;        // ì•µì»¤ íƒ€ì¼ X
    topLeftY: number;        // ì•µì»¤ íƒ€ì¼ Y
    isSecondaryTile?: boolean;  // ë³´ì¡° íƒ€ì¼ ì—¬ë¶€
}
```

- ì•µì»¤ íƒ€ì¼: `isSecondaryTile = false` (ì´ë¯¸ì§€ ë Œë”ë§ ë‹´ë‹¹)
- ë³´ì¡° íƒ€ì¼: `isSecondaryTile = true` (ì¶©ëŒ ì˜ì—­ë§Œ ì°¨ì§€)

### 15.3 í¼ë¸”ë¦¬ì‹œ í”Œë¡œìš°

```
1. ì•„ì´í…œ ë°°ì¹˜ (customTilesì— ì €ì¥)
      â†“
2. "Publish" í´ë¦­
      â†“
3. POST /api/custom-tiles { userId, customTiles }
      â†“
4. Redis 'global-tiles'ì— ë³‘í•© ì €ì¥
      â†“
5. customTiles â†’ publishedTilesë¡œ ì´ë™
      â†“
6. layer1 ì•„ì´í…œ ìœ„ì¹˜ë¥¼ collisionMapì— ì¶”ê°€
      â†“
7. customTiles ì´ˆê¸°í™” (draft í´ë¦¬ì–´)
```

---

## 16. ì±„íŒ… ë° ìŠ¤ë ˆë”© ì‹œìŠ¤í…œ

### 16.1 ìŠ¤ë ˆë“œ ê´€ë¦¬

**ìŠ¤ë ˆë“œ ì‹ë³„**: ì—ì´ì „íŠ¸ ì¡°í•©ì˜ SHA-256 í•´ì‹œ (`agentComboId`)

```typescript
// src/lib/hash.ts
async function generateAgentComboId(agentNames: string[]): Promise<string> {
    const sorted = [...agentNames].map(n => n.trim().toLowerCase()).sort();
    const combined = sorted.join('|');
    // Browser: Web Crypto API / Node: crypto module
    return sha256(combined);
}
```

ê°™ì€ ì—ì´ì „íŠ¸ ì¡°í•©ì´ë©´ ê°™ì€ ìŠ¤ë ˆë“œë¥¼ ì¬ì‚¬ìš©í•œë‹¤.

### 16.2 ë©”ì‹œì§€ ì „ì†¡ í”Œë¡œìš°

```
ì‚¬ìš©ì ë©”ì‹œì§€ ì…ë ¥
      â†“
POST /api/thread-message
  â”œâ”€â”€ playerPositionìœ¼ë¡œ ë°˜ê²½ ë‚´ ì—ì´ì „íŠ¸ íƒìƒ‰ (ìœ í´ë¦¬ë“œ ê±°ë¦¬)
  â”œâ”€â”€ @ë©˜ì…˜ëœ ì—ì´ì „íŠ¸ í¬í•¨
  â”œâ”€â”€ agentComboId ìƒì„±
  â”œâ”€â”€ ê¸°ì¡´ ìŠ¤ë ˆë“œ ê²€ìƒ‰ (Redis) â†’ ì—†ìœ¼ë©´ A2A Orchestrationì— ìƒì„±
  â”œâ”€â”€ ìŠ¤ë ˆë“œì— ì—ì´ì „íŠ¸ ì¶”ê°€
  â””â”€â”€ ë©”ì‹œì§€ ì „ì†¡
      â†“
SSE Stream (GET /api/thread-stream/[threadId])
  â”œâ”€â”€ A2A Orchestration ì„œë²„ì˜ SSEë¥¼ í”„ë¡ì‹œ
  â”œâ”€â”€ ì—ì´ì „íŠ¸ ì‘ë‹µì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬
  â””â”€â”€ 5ë¶„ íƒ€ì„ì•„ì›ƒ
```

### 16.3 SSE ì—°ê²° ê´€ë¦¬ (useThreadStream)

```typescript
// ì—°ê²° ìƒíƒœ: disconnected â†’ connecting â†’ connected â†’ error/reconnecting
// ì¬ì—°ê²°: ì§€ìˆ˜ ë°±ì˜¤í”„ (1s â†’ 2s â†’ 4s â†’ 8s â†’ 16s), ìµœëŒ€ 5íšŒ
// ì—ëŸ¬ ì‹œ Sentry ë³´ê³ 
```

### 16.4 Redis ìŠ¤ë ˆë“œ ì €ì¥ êµ¬ì¡°

```
user:{userId}:threads         â†’ Hash { threadId: JSON(Thread) }
user:{userId}:agent_combos    â†’ Hash { agentComboId: threadId }
```

- ë§Œë£Œ: 30ì¼

---

## 17. Custom Hooks ìƒì„¸

### useGameState (`hooks/useGameState.tsx`)

**ê°€ì¥ í° hook** â€” ê²Œì„ í•µì‹¬ ë¡œì§ ë‹´ë‹¹

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| í”Œë ˆì´ì–´ ì´ë™ | í‚¤ë³´ë“œ/ì¡°ì´ìŠ¤í‹± ì…ë ¥ ì²˜ë¦¬, ì¶©ëŒ ê°ì§€ |
| ìœ„ì¹˜ ê´€ë¦¬ | worldPosition ê°±ì‹ , ì„œë²„ ë™ê¸°í™” |
| ê°€ì‹œ ì˜ì—­ | ë§µ ë°ì´í„° + ì—ì´ì „íŠ¸ ê°€ì‹œì„± ê³„ì‚° |
| AI í•´ì„¤ | ììœ¨ ì´ë™ ì‹œ Gemini ê¸°ë°˜ í•´ì„¤ ìƒì„± |
| ì§€í˜• ê°ì§€ | í˜„ì¬ ìœ„ì¹˜ì˜ ë°”ì´ì˜´/ì§€í˜• íŒë³„ |

### useThreadStream (`hooks/useThreadStream.ts`)

SSE ìŠ¤íŠ¸ë¦¼ ê´€ë¦¬ hook

```typescript
interface Return {
    reconnect: () => void;          // ìˆ˜ë™ ì¬ì—°ê²°
    disconnect: () => void;          // ìˆ˜ë™ í•´ì œ
    isConnected: boolean;
    connectionStatus: 'disconnected' | 'connecting' | 'connected' | 'error' | 'reconnecting';
    lastError: string | null;
    reconnectAttempts: number;
}
```

### useAgents (`hooks/useAgents.ts`)

ì—ì´ì „íŠ¸ AI í–‰ë™, ê²½ë¡œ íƒìƒ‰, ì¶©ëŒ ë¡œì§

### useTiledMap (`hooks/useTiledMap.ts`)

Tiled(.tmj) ë§µ íŒŒì¼ ë¡œë“œ, Canvas ë Œë”ë§

### useSession (`hooks/useSession.ts`)

Firebase auth, ì‚¬ìš©ì ê´€ë¦¬

### useKeyboardOpen (`hooks/useKeyboardOpen.ts`)

ëª¨ë°”ì¼ ê°€ìƒ í‚¤ë³´ë“œ ê°ì§€ (í™”ë©´ ë†’ì´ ë³€í™” ê¸°ë°˜)

### useProgressiveImage (`hooks/useProgressiveImage.ts`)

ì´ë¯¸ì§€ ì§€ì—° ë¡œë”© ì „ëµ

### useSpritePreload (`hooks/useSpritePreload.ts`)

ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ í”„ë¦¬ë¡œë“œ

### useSearchHolders (`hooks/useSearchHolders.ts`)

í† í° í™€ë” ê²€ì¦ (AIN, sAIN, Mini Egg NFT)

### useWorld (`hooks/useWorld.ts`)

ì›”ë“œ ìƒíƒœ ê´€ë¦¬

---

## 18. ìœ í‹¸ë¦¬í‹° ë¼ì´ë¸ŒëŸ¬ë¦¬

### lib/utils.ts

```typescript
// Tailwind í´ë˜ìŠ¤ ë³‘í•©
function cn(...inputs: ClassValue[]) {
    return twMerge(clsx(inputs));
}

// UUID ì„¸ì…˜ ìƒì„±
function createSession(): string {
    return uuidv4();
}

// ì§€ê°‘ ì£¼ì†Œ ì¶•ì•½ (0x1234...5678)
function shortAddress(address: string, startIndex = 3): string
```

### lib/a2aOrchestration.ts

A2A ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ API í´ë¼ì´ì–¸íŠ¸:

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `createThread(userId, name)` | ìŠ¤ë ˆë“œ ìƒì„± |
| `importAgent(a2aUrl)` | ì—ì´ì „íŠ¸ ì„í¬íŠ¸ |
| `addAgentToThread(threadId, agent)` | ìŠ¤ë ˆë“œì— ì—ì´ì „íŠ¸ ì¶”ê°€ |
| `sendMessage(threadId, message)` | ë©”ì‹œì§€ ì „ì†¡ |
| `getAllThreads()` | ìŠ¤ë ˆë“œ ëª©ë¡ ì¡°íšŒ |
| `getThread(threadId)` | ê°œë³„ ìŠ¤ë ˆë“œ ì¡°íšŒ |
| `deleteThread(threadId)` | ìŠ¤ë ˆë“œ ì‚­ì œ |
| `removeAgentFromThread(threadId, agentName)` | ì—ì´ì „íŠ¸ ì œê±° |
| `connectToThreadStream(threadId, onMessage)` | SSE ì—°ê²° (EventSource) |

### lib/redis.ts

Redis í´ë¼ì´ì–¸íŠ¸ + ë°ì´í„° CRUD:

| í•¨ìˆ˜ | Redis í‚¤ | ë§Œë£Œ |
|------|----------|------|
| `savePlayerPosition` | `player:{userId}` (Hash) | 24ì‹œê°„ |
| `getPlayerPosition` | `player:{userId}` | - |
| `saveCustomTiles` | `global-tiles` (Hash) | ì—†ìŒ (ì˜êµ¬) |
| `getCustomTiles` | `global-tiles` | - |
| `getAgents` | `agents:*` (String) | - |
| `saveThread` | `user:{userId}:threads` + `user:{userId}:agent_combos` | 30ì¼ |
| `getThreads` | `user:{userId}:threads` | - |
| `findThreadByAgentCombo` | `user:{userId}:agent_combos` â†’ thread lookup | - |
| `deleteThread` | ì–‘ìª½ í‚¤ ì‚­ì œ | - |

**ì£¼ì˜**: `saveCustomTiles`ëŠ” global í‚¤ì— ë³‘í•© ì €ì¥. userIdëŠ” í•˜ìœ„ í˜¸í™˜ìš©ìœ¼ë¡œ ë°›ì§€ë§Œ ì‹¤ì œë¡œ ë¬´ì‹œ.

### lib/hash.ts

```typescript
// ì—ì´ì „íŠ¸ ì¡°í•© í•´ì‹œ (Browser: Web Crypto / Node: crypto)
async function generateAgentComboId(agentNames: string[]): Promise<string>
```

---

## 19. API ë¼ìš°íŠ¸ ìƒì„¸

### 19.1 `/api/agents` (CRUD)

**GET**: ëª¨ë“  ì—ì´ì „íŠ¸ ì¡°íšŒ
```
Query: ?address={creatorAddress}  (ì„ íƒì‚¬í•­)
Response: { success: true, agents: StoredAgent[], count: number }
```

**POST**: ì—ì´ì „íŠ¸ ë“±ë¡
```json
{
    "url": "https://agent-a2a-url",
    "card": { /* AgentCard */ },
    "state": { "x": 0, "y": 0, "behavior": "random", "color": "#FF6B6B" },
    "isPlaced": false,
    "spriteUrl": "...",
    "spriteHeight": 50
}
```
- Redis í‚¤: `agents:{base64(url)}`
- ì¤‘ë³µ ë“±ë¡ ì‹œ 409 Conflict

**PUT**: ì—ì´ì „íŠ¸ ì—…ë°ì´íŠ¸ (partial update)
```json
{
    "url": "https://agent-url",
    "state": { "x": 5, "y": 10 },
    "isPlaced": true
}
```

**DELETE**: ì—ì´ì „íŠ¸ ì‚­ì œ
```json
{ "url": "https://agent-url" }
```

### 19.2 `/api/agents/upload-image`

**POST** (FormData):
```
image: File      # ì´ë¯¸ì§€ íŒŒì¼
agentUrl: string # ì—ì´ì „íŠ¸ URL
```

**ì²˜ë¦¬ ê³¼ì •**:
1. sharpë¡œ ì´ë¯¸ì§€ dimensions ì¶”ì¶œ
2. Firebase Storageì— ì—…ë¡œë“œ (production/develop ë²„í‚· êµ¬ë¶„)
3. ê¸°ì¡´ ìŠ¤í”„ë¼ì´íŠ¸ íŒŒì¼ ì‚­ì œ
4. Redis ì—ì´ì „íŠ¸ ë°ì´í„°ì— `spriteUrl`, `spriteHeight` ì—…ë°ì´íŠ¸

### 19.3 `/api/agent-chat`

**POST**: A2A SDKë¡œ ì—ì´ì „íŠ¸ì— ë©”ì‹œì§€ ì „ì†¡
```json
{
    "agentUrl": "https://agent-url",
    "message": "Hello agent",
    "contextId": "optional-context-id"
}
```
- JSON-RPC, direct, nested ë“± ë‹¤ì–‘í•œ ì‘ë‹µ í¬ë§· íŒŒì‹±

### 19.4 `/api/thread-message`

**POST**: ìŠ¤ë ˆë“œ ë©”ì‹œì§€ ì „ì†¡ + ì—ì´ì „íŠ¸ íƒìƒ‰
```json
{
    "message": "Hello everyone",
    "playerPosition": { "x": 10, "y": 20 },
    "broadcastRadius": 5,
    "threadId": "optional",
    "agentNames": ["Agent1"],
    "mentionedAgents": ["Agent2"],
    "userId": "user-id"
}
```

**ì—ì´ì „íŠ¸ íƒìƒ‰ ë¡œì§**:
- ìœ í´ë¦¬ë“œ ê±°ë¦¬: `sqrt((ax-px)^2 + (ay-py)^2) <= broadcastRadius`
- ëª…ì‹œì ìœ¼ë¡œ ì§€ì •ëœ ì—ì´ì „íŠ¸ + ë°˜ê²½ ë‚´ ì—ì´ì „íŠ¸ ë³‘í•©

### 19.5 `/api/thread-stream/[threadId]`

**GET**: SSE í”„ë¡ì‹œ
```
Headers:
  Content-Type: text/event-stream
  Cache-Control: no-cache, no-transform
  Connection: keep-alive
  X-Accel-Buffering: no
```
- A2A Orchestrationì˜ SSEë¥¼ í´ë¼ì´ì–¸íŠ¸ì— í”„ë¡ì‹œ
- ìµœëŒ€ 5ë¶„ ìœ ì§€
- AbortControllerë¡œ ì—°ê²° ì •ë¦¬

### 19.6 `/api/custom-tiles`

**GET**: `?userId={id}` â†’ ê¸€ë¡œë²Œ íƒ€ì¼ ì¡°íšŒ
**POST**: ì»¤ìŠ¤í…€ íƒ€ì¼ ì €ì¥ (ê¸°ì¡´ ê¸€ë¡œë²Œ íƒ€ì¼ì— ë³‘í•©)

### 19.7 `/api/position`

**GET**: `?userId={id}` â†’ í”Œë ˆì´ì–´ ìœ„ì¹˜ ì¡°íšŒ (ê¸°ë³¸ê°’: 0,0)
**POST**: `{ userId, x, y }` â†’ ìœ„ì¹˜ ì €ì¥ (24ì‹œê°„ ë§Œë£Œ)

### 19.8 `/api/create-agent`

**POST**: AI í”„ë¡¬í”„íŠ¸ë¡œ ì—ì´ì „íŠ¸ ìƒì„±
```json
{ "prompt": "Create a helpful weather agent" }
```

**ì²˜ë¦¬ ê³¼ì •**:
1. ë¹Œë” APIë¡œ ì—ì´ì „íŠ¸ config ìƒì„±
2. í•„ìˆ˜ í•„ë“œ ì¶”ê°€ (id, url, protocolVersion, etc.)
3. ë¹Œë” ì„œë¹„ìŠ¤ì— ë°°í¬
4. A2A ì—”ë“œí¬ì¸íŠ¸ URL ë°˜í™˜

---

## 20. ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™

### 20.1 A2A Orchestration

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ìš©ë„ |
|------------|--------|------|
| `/threads` | POST | ìŠ¤ë ˆë“œ ìƒì„± |
| `/threads` | GET | ìŠ¤ë ˆë“œ ëª©ë¡ |
| `/threads/{id}` | GET/DELETE | ìŠ¤ë ˆë“œ ì¡°íšŒ/ì‚­ì œ |
| `/threads/{id}/agents` | POST | ì—ì´ì „íŠ¸ ì¶”ê°€ |
| `/threads/{id}/agents/{name}` | DELETE | ì—ì´ì „íŠ¸ ì œê±° |
| `/threads/{id}/messages` | POST | ë©”ì‹œì§€ ì „ì†¡ |
| `/threads/{id}/stream` | GET (SSE) | ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼ |
| `/agents/import` | POST | ì—ì´ì „íŠ¸ ì„í¬íŠ¸ |

ê¸°ë³¸ URL: `NEXT_PUBLIC_A2A_ORCHESTRATION_BASE_URL`

### 20.2 Redis ë°ì´í„° êµ¬ì¡°

```
player:{userId}                  â†’ Hash { x, y, lastUpdated }           # 24h TTL
global-tiles                     â†’ Hash { tiles: JSON, lastUpdated }    # ì˜êµ¬
agents:{base64(url)}             â†’ String (JSON StoredAgent)            # ì˜êµ¬
user:{userId}:threads            â†’ Hash { threadId: JSON(Thread) }      # 30ì¼ TTL
user:{userId}:agent_combos       â†’ Hash { agentComboId: threadId }      # 30ì¼ TTL
```

### 20.3 Firebase Storage

- ì—ì´ì „íŠ¸ ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì €ì¥
- ë²„í‚·: production/develop êµ¬ë¶„
- íŒŒì¼ëª…: `agent_sprite_{base64(agentUrl)}_{timestamp}.{ext}`

### 20.4 Sentry

- Server: `sentry.server.config.ts`
- Edge: `sentry.edge.config.ts`
- Client: Next.js ìë™ ì„¤ì •
- Org: `comcom-xr`, Project: `ainspace`

### 20.5 Farcaster

- **MiniApp SDK**: `sdk.actions.ready({ disableNativeGestures: true })`
- **Manifest**: `/.well-known/farcaster.json` â†’ Farcaster hosted manifest ë¦¬ë‹¤ì´ë ‰íŠ¸
- **Frame Metadata**: `fc:frame` JSON ë©”íƒ€ë°ì´í„° (layout.tsx)

---

## 21. ìŠ¤íƒ€ì¼ë§ ì‹œìŠ¤í…œ

### Tailwind CSS v4

```css
/* globals.css */
@import 'tailwindcss';
@import 'tw-animate-css';      /* ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ */
@custom-variant dark (&:is(.dark *));  /* ë‹¤í¬ ëª¨ë“œ ì»¤ìŠ¤í…€ ë³€í˜• */
```

### í°íŠ¸

```typescript
// layout.tsx
const geistSans = Geist({ variable: '--font-geist-sans', subsets: ['latin'] });
const geistMono = Geist_Mono({ variable: '--font-geist-mono', subsets: ['latin'] });
const manrope = Manrope({ variable: '--font-manrope', subsets: ['latin'] });
```

### ëª¨ë°”ì¼ ìµœì í™” CSS

```css
/* í„°ì¹˜ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
* { -webkit-tap-highlight-color: transparent; }

/* Canvas/ì´ë¯¸ì§€ ì„ íƒ ë°©ì§€ */
canvas, img { -webkit-user-select: none; user-select: none; }

/* ì¸í’‹ì€ ì„ íƒ í—ˆìš© */
input, textarea { -webkit-user-select: text !important; }

/* ë”ë¸”íƒ­ ì¤Œ ë°©ì§€ */
button, a { touch-action: manipulation; }

/* ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ ë°©ì§€ */
body { overscroll-behavior-y: contain; }
```

### ë””ìì¸ í† í° (CSS Variables)

```css
:root {
    --radius: 0.625rem;
    --background: oklch(1 0 0);          /* í°ìƒ‰ */
    --foreground: oklch(0.145 0 0);      /* ê±°ì˜ ê²€ì • */
    --primary: oklch(0.205 0 0);
    --destructive: oklch(0.577 0.245 27.325);  /* ë¹¨ê°• */
    /* ... ì „ì²´ Shadcn í…Œë§ˆ ë³€ìˆ˜ */
}
```

### ì»´í¬ë„ŒíŠ¸ ë³€í˜• (CVA)

```typescript
// cn() ìœ í‹¸ë¡œ ì¡°ê±´ë¶€ í´ë˜ìŠ¤ ì ìš©
cn(
    'flex flex-1 cursor-pointer flex-col items-center justify-center',
    activeTab === 'map' ? 'text-gray-100' : 'bg-[#424049] text-white'
)
```

---

## 22. ë¹Œë“œ ë° ë°°í¬

### Next.js ì„¤ì • (`next.config.ts`)

```typescript
{
    images: {
        remotePatterns: [{ hostname: '**.public.blob.vercel-storage.com' }]
    },
    redirects: [
        // Farcaster manifest ë¦¬ë‹¤ì´ë ‰íŠ¸
        { source: '/.well-known/farcaster.json', destination: 'https://api.farcaster.xyz/...' }
    ],
    webpack: (config) => {
        // Productionì—ì„œ console.log ì œê±° (terser pure_funcs)
        // ë¸Œë¼ìš°ì € ë¶ˆí•„ìš” ëª¨ë“ˆ fallback: false
    }
}

// Sentry ë˜í•‘
export default withSentryConfig(nextConfig, {
    org: 'comcom-xr',
    project: 'ainspace',
    widenClientFileUpload: true,
    disableLogger: true,
    automaticVercelMonitors: true
});
```

### TypeScript ì„¤ì •

```json
{
    "target": "ES2017",
    "module": "esnext",
    "moduleResolution": "bundler",
    "strict": true,
    "jsx": "preserve",
    "paths": { "@/*": ["./src/*"] }
}
```

### ë°°í¬ (Vercel)

- Vercel ìë™ ë°°í¬
- ì†ŒìŠ¤ë§µ Sentry ì—…ë¡œë“œ
- Vercel Analytics ì—°ë™
- Blob Storageë¡œ íŒŒì¼ ì €ì¥

### ë©”íƒ€ë°ì´í„° (SEO/OG)

`layout.tsx`ì˜ `generateMetadata()`ì—ì„œ ìƒì„±:
- OpenGraph, Twitter Card
- Farcaster Frame ë©”íƒ€ë°ì´í„°
- í‚¤ì›Œë“œ: Web3, blockchain, Base, Farcaster, AI Network
- í™˜ê²½ë³„ íƒ€ì´í‹€: production â†’ "AINSPACE", dev â†’ "AINSPACE - DEV"

---

## 23. í•µì‹¬ ë™ì‘ íë¦„

### 23.1 ì•± ì‹œì‘ â†’ ê²Œì„ ì§„ì…

```
1. ë¸Œë¼ìš°ì € ì ‘ì†
2. RootLayout ë Œë”ë§
3. Providers ì´ˆê¸°í™”:
   a. WagmiProvider â†’ ì›”ë › ìƒíƒœ ë¡œë“œ
   b. QueryClientProvider â†’ React Query ì„¤ì •
   c. MapDataProvider â†’ ë§µ ë°ì´í„° ë¡œë“œ
   d. OnchainKitProvider â†’ Base ì²´ì¸ ì—°ê²°
4. AuthGuard:
   a. isMounted = false â†’ null ë Œë”ë§
   b. isConnecting â†’ ë¡œë”© ìŠ¤í”¼ë„ˆ
   c. wagmi hydration ì™„ë£Œ (100ms)
   d. !isConnected â†’ /login ë¦¬ë‹¤ì´ë ‰íŠ¸
   e. isConnected â†’ children ë Œë”ë§
5. page.tsx ë§ˆìš´íŠ¸:
   a. Farcaster frame ready
   b. Eruda ë””ë²„ê±° (dev only)
   c. ì¶©ëŒ ë§µ ì´ˆê¸°í™” (land_layer_1 ì´ë¯¸ì§€ ë¶„ì„)
   d. ì»¤ìŠ¤í…€ íƒ€ì¼ ë¡œë“œ (Redis)
   e. ë°°í¬ëœ ì—ì´ì „íŠ¸ ë¡œë“œ (Redis)
   f. Base ì²´ì¸ ìë™ ì „í™˜
```

### 23.2 ì—ì´ì „íŠ¸ ì„í¬íŠ¸ â†’ ë°°ì¹˜

```
1. AgentTabì—ì„œ A2A URL ì…ë ¥
2. POST /api/agent-proxy â†’ ì—ì´ì „íŠ¸ ì¹´ë“œ ì •ë³´ íšë“
3. POST /api/agents â†’ Redisì— ë“±ë¡ (isPlaced: false)
4. "Place" í´ë¦­:
   a. ALLOWED_DEPLOY_ZONE ë‚´ ë¹ˆ ì¢Œí‘œ íƒìƒ‰
   b. PUT /api/agents â†’ isPlaced: true, ì¢Œí‘œ ì €ì¥
   c. useAgentStore.spawnAgent() â†’ ë§µì— í‘œì‹œ
   d. activeTab â†’ 'map' ì „í™˜
```

### 23.3 ì—ì´ì „íŠ¸ì™€ ëŒ€í™”

```
1. ChatBoxì—ì„œ ë©”ì‹œì§€ ì…ë ¥ (ì„ íƒì ìœ¼ë¡œ @ë©˜ì…˜)
2. ë°˜ê²½ ë‚´ ì—ì´ì „íŠ¸ íƒìƒ‰ (BROADCAST_RADIUS)
3. ì—ì´ì „íŠ¸ ì¡°í•© í•´ì‹œ ìƒì„±
4. ê¸°ì¡´ ìŠ¤ë ˆë“œ ê²€ìƒ‰ (Redis agentComboId)
5. ì—†ìœ¼ë©´:
   a. A2A Orchestrationì— ìŠ¤ë ˆë“œ ìƒì„±
   b. Redisì— ìŠ¤ë ˆë“œ ì €ì¥
   c. ê° ì—ì´ì „íŠ¸ë¥¼ ìŠ¤ë ˆë“œì— ì¶”ê°€
6. ë©”ì‹œì§€ ì „ì†¡ (A2A Orchestration)
7. SSE ìŠ¤íŠ¸ë¦¼ ì—°ê²° (useThreadStream)
8. ì—ì´ì „íŠ¸ ì‘ë‹µ ì‹¤ì‹œê°„ ìˆ˜ì‹  â†’ ChatBoxì— í‘œì‹œ
```

### 23.4 ë§µ ë¹Œë”©

```
1. Build íƒ­ ì„ íƒ
2. ì•„ì´í…œ ì„ íƒ (6ì¢… ì¤‘ íƒ1)
3. ë§µì—ì„œ ìœ„ì¹˜ í´ë¦­ â†’ customTiles.layer1ì— ì¶”ê°€
4. ë©€í‹°íƒ€ì¼: ì•µì»¤ + ë³´ì¡° íƒ€ì¼ ìë™ ìƒì„±
5. "Publish" í´ë¦­:
   a. POST /api/custom-tiles â†’ Redis 'global-tiles'ì— ë³‘í•©
   b. customTiles â†’ publishedTiles ì´ë™
   c. collisionMapì— layer1 ì•„ì´í…œ ìœ„ì¹˜ ì¶”ê°€
   d. draft ì´ˆê¸°í™”
```

---

## 24. ì„¤ì • íŒŒì¼ ìƒì„¸

### package.json ìŠ¤í¬ë¦½íŠ¸

```json
{
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
}
```

### PostCSS ì„¤ì •

```javascript
// postcss.config.mjs
export default {
    plugins: {
        '@tailwindcss/postcss': {}
    }
};
```

### Prettier ì„¤ì •

```json
// .prettierrc
{
    "plugins": ["prettier-plugin-tailwindcss"]
}
```

### Shadcn UI ì„¤ì •

```json
// components.json
// Shadcn UI ì»´í¬ë„ŒíŠ¸ ë©”íƒ€ë°ì´í„°
```

### Sentry ì„¤ì •

```typescript
// sentry.server.config.ts - ì„œë²„ ì—ëŸ¬ ì¶”ì 
// sentry.edge.config.ts  - Edge Function ëª¨ë‹ˆí„°ë§
// instrumentation.ts     - ë¼ì´í”„ì‚¬ì´í´ í›…
```

---

## 25. ì£¼ì˜ì‚¬í•­ ë° ì•Œë ¤ì§„ ì´ìŠˆ

### í˜„ì¬ ë¹„í™œì„±í™”ëœ ê¸°ëŠ¥

1. **ì—ì´ì „íŠ¸ ìë™ ì´ë™**: `ENABLE_AGENT_MOVEMENT = false` â€” í™œì„±í™”í•˜ë©´ 100ms ê°„ê²©ìœ¼ë¡œ ì—ì´ì „íŠ¸ê°€ ëœë¤ ì´ë™
2. **ê¸°ë³¸ ì—ì´ì „íŠ¸**: `initializeDefaultAgents()`ê°€ í˜¸ì¶œë˜ì§€ë§Œ ì‹¤ì œ ì—ì´ì „íŠ¸ ë“±ë¡ì€ ì£¼ì„ ì²˜ë¦¬
3. **ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸**: `addAgent` íŠ¸ëœì­ì…˜ ì½”ë“œê°€ ì£¼ì„ ì²˜ë¦¬ (NOTE: yoojin)
4. **Thread íƒ­**: Footerì—ì„œ thread íƒ­ì´ ì œê±°ë¨, ì±„íŒ…ì€ ChatBoxOverlayì—ì„œ ì²˜ë¦¬

### ê°œë°œ ì‹œ ì£¼ì˜

1. **Redis í•„ìˆ˜**: ì—ì´ì „íŠ¸, íƒ€ì¼, ìŠ¤ë ˆë“œ ë°ì´í„° ëª¨ë‘ Redisì— ì €ì¥. Redis ì—†ìœ¼ë©´ ì¼ë¶€ APIì— in-memory fallback ìˆìŒ
2. **A2A Orchestration ì„œë²„**: ìŠ¤ë ˆë“œ/ë©”ì‹œì§€ ê¸°ëŠ¥ì€ ë³„ë„ ì„œë²„ í•„ìš”
3. **Farcaster í™˜ê²½**: MiniAppìœ¼ë¡œ ë™ì‘í•˜ë¯€ë¡œ ë„¤ì´í‹°ë¸Œ ì œìŠ¤ì²˜ ë¹„í™œì„±í™” ì„¤ì • í•„ìš”
4. **ì¶©ëŒ ë§µ**: ì²« ë¡œë“œ ì‹œ 25ê°œ íƒ€ì¼ ì´ë¯¸ì§€ë¥¼ Canvasì— ê·¸ë ¤ ë¶„ì„í•˜ë¯€ë¡œ ì´ˆê¸° ë¡œë”© ì‹œê°„ ìˆìŒ
5. **ëª¨ë°”ì¼ ìµœì í™”**: viewport `user-scalable=no`, í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™” CSS ì ìš©ë¨
6. **Eruda ë””ë²„ê±°**: `NEXT_PUBLIC_NODE_ENV !== 'production'`ì¼ ë•Œ ìë™ í™œì„±í™”

### ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

1. **Canvas ë Œë”ë§**: DOM ëŒ€ì‹  Canvasë¡œ ë§µ ë Œë”ë§ â†’ ì„±ëŠ¥ ìµœì í™”
2. **Zustand**: ìµœì†Œ ë¦¬ë Œë”ë§ì„ ìœ„í•œ ê²½ëŸ‰ ìƒíƒœ ê´€ë¦¬
3. **ì´ë¯¸ì§€ í”„ë¦¬ë¡œë”©**: ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì‚¬ì „ ë¡œë“œ
4. **SSE í”„ë¡ì‹œ**: CORS íšŒí”¼ë¥¼ ìœ„í•œ ì„œë²„ í”„ë¡ì‹œ
5. **Production**: console.log ì œê±° (terser pure_funcs)

### ì°¸ê³  ì™¸ë¶€ URL

| ì„œë¹„ìŠ¤ | URL íŒ¨í„´ |
|--------|----------|
| Vercel ë°°í¬ | `https://ainspace-4g3e.vercel.app` |
| API ì„œë²„ | `https://base-backend-dev.ainetwork.xyz` |
| A2A Orchestration | `https://a2a-orchestration-dev.ainetwork.ai/api` |
| Farcaster Manifest | `https://api.farcaster.xyz/miniapps/hosted-manifest/...` |

---

## ë¶€ë¡: ì¬êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì´ ë¬¸ì„œë§Œìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì²˜ìŒë¶€í„° ì¬êµ¬í˜„í•˜ê¸° ìœ„í•œ ìˆœì„œ:

### Phase 1: í”„ë¡œì íŠ¸ ì…‹ì—…
- [ ] Next.js 15 (App Router) + TypeScript strict í”„ë¡œì íŠ¸ ìƒì„±
- [ ] íŒ¨í‚¤ì§€ ì„¤ì¹˜ (package.json ì°¸ê³ )
- [ ] Tailwind CSS v4 + PostCSS ì„¤ì •
- [ ] tsconfig.json (`@/*` path alias í¬í•¨)
- [ ] next.config.ts (ì´ë¯¸ì§€, Farcaster ë¦¬ë‹¤ì´ë ‰íŠ¸, webpack, Sentry)

### Phase 2: ì¸í”„ë¼ ë ˆì´ì–´
- [ ] Redis í´ë¼ì´ì–¸íŠ¸ (lib/redis.ts)
- [ ] Wagmi ì„¤ì • (lib/wagmi-config.ts)
- [ ] ìœ í‹¸ë¦¬í‹° (lib/utils.ts, lib/hash.ts)
- [ ] í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env)

### Phase 3: ìƒíƒœ ê´€ë¦¬
- [ ] 7ê°œ Zustand ìŠ¤í† ì–´ êµ¬í˜„ (stores/)
- [ ] íƒ€ì… ì •ì˜ (types/thread.ts)
- [ ] ê²Œì„ ìƒìˆ˜ (constants/game.ts, common.ts)

### Phase 4: Provider & Auth
- [ ] Providers.tsx (Wagmi â†’ Query â†’ MapData â†’ OnchainKit)
- [ ] AuthGuard.tsx (ì›”ë › ì¸ì¦ ê°€ë“œ)
- [ ] layout.tsx (í°íŠ¸, ë©”íƒ€ë°ì´í„°, Provider ë˜í•‘)

### Phase 5: ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ
- [ ] ì—ì´ì „íŠ¸ í´ë˜ìŠ¤ ê³„ì¸µ (lib/agent.ts)
- [ ] A2A Orchestration í´ë¼ì´ì–¸íŠ¸ (lib/a2aOrchestration.ts)
- [ ] ì—ì´ì „íŠ¸ API ë¼ìš°íŠ¸ (/api/agents, agent-chat, agent-proxy, agent-response, create-agent)

### Phase 6: ë§µ ì‹œìŠ¤í…œ
- [ ] TileMap ìº”ë²„ìŠ¤ ë Œë”ëŸ¬ (components/TileMap.tsx)
- [ ] useTiledMap, useGameState hooks
- [ ] ì¶©ëŒ ë§µ ìƒì„± (useBuildStore.updateCollisionMapFromImage)
- [ ] ë§µ ë¦¬ì†ŒìŠ¤ (public/map/)

### Phase 7: UI ì»´í¬ë„ŒíŠ¸
- [ ] Footer (íƒ­ ë„¤ë¹„ê²Œì´ì…˜)
- [ ] MapTab (ê²Œì„ ë””ìŠ¤í”Œë ˆì´ + ì¡°ì´ìŠ¤í‹±)
- [ ] AgentTab (ì—ì´ì „íŠ¸ ê´€ë¦¬)
- [ ] TempBuildTab (ë§µ ë¹Œë”©)

### Phase 8: ì±„íŒ… ì‹œìŠ¤í…œ
- [ ] ChatBox (ë©”ì‹œì§€ UI + @ë©˜ì…˜)
- [ ] ChatBoxOverlay + ChatBottomDrawer
- [ ] useThreadStream (SSE)
- [ ] ìŠ¤ë ˆë“œ API ë¼ìš°íŠ¸ (/api/threads, thread-message, thread-stream)

### Phase 9: ë¡œê·¸ì¸ & ë¶€ê°€ê¸°ëŠ¥
- [ ] ë¡œê·¸ì¸ í˜ì´ì§€ (Signature + ì›”ë ›)
- [ ] Farcaster MiniApp í†µí•©
- [ ] Sentry ì—ëŸ¬ íŠ¸ë˜í‚¹
- [ ] Vercel Analytics

### Phase 10: ë°°í¬
- [ ] Vercel ë°°í¬ ì„¤ì •
- [ ] Redis í”„ë¡œë¹„ì €ë‹
- [ ] í™˜ê²½ë³€ìˆ˜ ë“±ë¡
- [ ] Sentry í”„ë¡œì íŠ¸ ì—°ê²°
